import{u as R}from"./logStore-WlSzgsUM.js";import{_ as D,c as p,a as s,d,e as m,r as x,f as g,i as f,v as b,t as y,o as c,p as T,F as k,m as U,j as z,n as w,k as P,l as I,h as E,g as _}from"./index-CLqOJ2F5.js";import N from"./EmbedPlayerView-BTRXHQ9x.js";import{P as O,C as F,b as A}from"./BGMPlayer-DL3EqeS_.js";const L={name:"StepEffectsEditor",props:{totalSteps:{type:Number,required:!0},selectedStep:{type:Number,default:null},currentEffects:{type:Object,default:null},currentIllustrations:{type:Array,default:()=>[]}},data(){return{startStep:1,endStep:1,effects:{sfx:"",bgm:"",background:"",backgroundOpacity:.3},isLoadingFile:!1}},computed:{canApply(){return this.startStep>=1&&this.endStep>=this.startStep&&this.endStep<=this.totalSteps},hasAnyEffect(){return this.effects.sfx||this.effects.bgm||this.effects.background},canApplyIllustrationsRange(){return this.canApply&&this.selectedStep!==null},currentIllustrationsCount(){return Array.isArray(this.currentIllustrations)?this.currentIllustrations.length:0}},methods:{formatPreviewUrl(t){return t?t.startsWith("data:")?`[ë¡œì»¬ ${t.split(";")[0].split(":")[1].split("/")[0]==="audio"?"ì˜¤ë””ì˜¤":"ì´ë¯¸ì§€"} íŒŒì¼]`:t:""},formatPreviewUrl(t){return t?t.startsWith("data:")?`[ë¡œì»¬ ${t.split(";")[0].split(":")[1].split("/")[0]==="audio"?"ì˜¤ë””ì˜¤":"ì´ë¯¸ì§€"} íŒŒì¼]`:t:""},async handleSfxFileSelect(t){const e=t.target.files[0];if(e){if(e.size>5*1024*1024){alert("íŒŒì¼ í¬ê¸°ëŠ” 5MB ì´í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤."),t.target.value="";return}this.isLoadingFile=!0;try{const r=await this.fileToBase64(e);this.effects.sfx=r,console.log("[StepEffectsEditor] íš¨ê³¼ìŒ íŒŒì¼ ë¡œë“œ ì™„ë£Œ:",{fileName:e.name,fileSize:e.size,base64Length:r.length})}catch(r){console.error("[StepEffectsEditor] íŒŒì¼ ë¡œë“œ ì‹¤íŒ¨:",r),alert("íŒŒì¼ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}finally{this.isLoadingFile=!1,t.target.value=""}}},fileToBase64(t){return new Promise((e,r)=>{const h=new FileReader;h.onload=()=>e(h.result),h.onerror=r,h.readAsDataURL(t)})},clearSfx(){this.effects.sfx=""},async handleBgmFileSelect(t){const e=t.target.files[0];if(e){if(e.size>10*1024*1024){alert("BGM íŒŒì¼ í¬ê¸°ëŠ” 10MB ì´í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤."),t.target.value="";return}this.isLoadingFile=!0;try{const r=await this.fileToBase64(e);this.effects.bgm=r,console.log("[StepEffectsEditor] BGM íŒŒì¼ ë¡œë“œ ì™„ë£Œ:",{fileName:e.name,fileSize:e.size,base64Length:r.length})}catch(r){console.error("[StepEffectsEditor] íŒŒì¼ ë¡œë“œ ì‹¤íŒ¨:",r),alert("íŒŒì¼ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}finally{this.isLoadingFile=!1,t.target.value=""}}},clearBgm(){this.effects.bgm=""},async handleBgFileSelect(t){const e=t.target.files[0];if(e){if(e.size>2*1024*1024){alert("ì´ë¯¸ì§€ íŒŒì¼ í¬ê¸°ëŠ” 2MB ì´í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤."),t.target.value="";return}this.isLoadingFile=!0;try{const r=await this.fileToBase64(e);this.effects.background=r,console.log("[StepEffectsEditor] ë°°ê²½ ì´ë¯¸ì§€ ë¡œë“œ ì™„ë£Œ:",{fileName:e.name,fileSize:e.size,base64Length:r.length})}catch(r){console.error("[StepEffectsEditor] íŒŒì¼ ë¡œë“œ ì‹¤íŒ¨:",r),alert("íŒŒì¼ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}finally{this.isLoadingFile=!1,t.target.value=""}}},clearBackground(){this.effects.background=""},convertToDirectURL(t){if(!t||!t.trim())return t;const e=t.trim();if(e.startsWith("data:"))return e;const r=e.match(/drive\.google\.com\/file\/d\/([^\/\?]+)/);return r?`https://docs.google.com/uc?export=download&id=${r[1]}`:e.includes("dropbox.com")?e.replace(/[?&]dl=0/,"?dl=1"):e.includes("1drv.ms")||e.includes("onedrive.live.com")?e.replace("/embed?","/download?"):e},applyEffects(){this.canApply&&(this.$emit("apply",{startStep:this.startStep,endStep:this.endStep,effects:{sfx:this.convertToDirectURL(this.effects.sfx)||null,bgm:this.convertToDirectURL(this.effects.bgm)||null,background:this.convertToDirectURL(this.effects.background)||null,backgroundOpacity:this.effects.backgroundOpacity}}),this.resetForm())},removeEffects(){this.canApply&&(this.$emit("remove",{startStep:this.startStep,endStep:this.endStep}),this.resetForm())},applyIllustrationsRange(){if(!this.canApplyIllustrationsRange)return;const t=JSON.parse(JSON.stringify(this.currentIllustrations||[]));t.length===0&&!confirm(`í˜„ì¬ ìŠ¤í…ì˜ ì¼ëŸ¬ìŠ¤íŠ¸ê°€ ë¹„ì–´ìˆìŠµë‹ˆë‹¤.
ì§€ì •í•œ ë²”ìœ„ì˜ ì¼ëŸ¬ìŠ¤íŠ¸ë¥¼ ëª¨ë‘ ì œê±°í• ê¹Œìš”?`)||this.$emit("apply-illustrations-range",{startStep:this.startStep,endStep:this.endStep,illustrations:t})},resetForm(){this.effects={sfx:"",bgm:"",background:"",backgroundOpacity:.3}},loadStepEffects(){this.selectedStep!==null&&(this.startStep=this.selectedStep,this.endStep=this.selectedStep),this.currentEffects&&(this.effects={sfx:this.currentEffects.sfx||"",bgm:this.currentEffects.bgm||"",background:this.currentEffects.background||"",backgroundOpacity:this.currentEffects.backgroundOpacity??.3})}},watch:{selectedStep:{immediate:!0,handler(){this.loadStepEffects()}},currentEffects:{immediate:!0,handler(){this.loadStepEffects()}}}},M={class:"step-effects-editor"},H={class:"editor-header"},J={class:"editor-body"},G={class:"section"},W={class:"step-range"},X={class:"input-group"},q=["max"],K={class:"input-group"},Y=["min","max"],Q={class:"section"},Z={class:"file-input-group"},$={class:"hint-text"},ee={class:"section"},te={class:"file-input-group"},se={class:"hint-text"},le={class:"section"},oe={class:"file-input-group"},ae={class:"hint-text"},ie={key:0,class:"opacity-control"},re={class:"section"},ne={class:"hint-text"},de={key:0,class:"section preview-section"},ue={class:"preview-list"},ce={key:0,class:"preview-item"},pe={key:1,class:"preview-item"},he={key:2,class:"preview-item"},me={key:3,class:"preview-item"},fe={class:"actions"},ge=["disabled"],ve=["disabled"],be=["disabled"];function ye(t,e,r,h,l,a){const i=x("EmojiToIcon");return c(),p("div",M,[s("div",H,[s("h3",null,[d(i,{emoji:"âœ¨",size:20}),e[18]||(e[18]=m(" ìŠ¤í… íš¨ê³¼ í¸ì§‘ê¸° ",-1))])]),s("div",J,[s("div",G,[e[21]||(e[21]=s("h4",null,"ëŒ€ìƒ ìŠ¤í… ì„ íƒ",-1)),s("div",W,[s("div",X,[e[19]||(e[19]=s("label",null,"ì‹œì‘ ìŠ¤í…",-1)),f(s("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>l.startStep=o),type:"number",min:1,max:r.totalSteps,placeholder:"1"},null,8,q),[[b,l.startStep,void 0,{number:!0}]])]),s("div",K,[e[20]||(e[20]=s("label",null,"ì¢…ë£Œ ìŠ¤í…",-1)),f(s("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>l.endStep=o),type:"number",min:l.startStep,max:r.totalSteps,placeholder:"1"},null,8,Y),[[b,l.endStep,void 0,{number:!0}]])])]),e[22]||(e[22]=s("p",{class:"hint-text"}," ë‹¨ì¼ ìŠ¤í…: ì‹œì‘ê³¼ ì¢…ë£Œë¥¼ ê°™ì€ ë²ˆí˜¸ë¡œ ì„¤ì • | ë²”ìœ„: ë‹¤ë¥¸ ë²ˆí˜¸ë¡œ ì„¤ì • ",-1))]),s("div",Q,[s("h4",null,[d(i,{emoji:"ğŸ”Š",size:16}),e[23]||(e[23]=m(" íš¨ê³¼ìŒ (SFX) ",-1))]),s("div",Z,[f(s("input",{"onUpdate:modelValue":e[2]||(e[2]=o=>l.effects.sfx=o),type:"text",placeholder:"íš¨ê³¼ìŒ URL ì…ë ¥ ë˜ëŠ” íŒŒì¼ ì„ íƒ ë²„íŠ¼ í´ë¦­",class:"url-input"},null,512),[[b,l.effects.sfx]]),s("input",{ref:"sfxFileInput",type:"file",accept:"audio/*",onChange:e[3]||(e[3]=(...o)=>a.handleSfxFileSelect&&a.handleSfxFileSelect(...o)),style:{display:"none"}},null,544),s("button",{onClick:e[4]||(e[4]=o=>t.$refs.sfxFileInput.click()),class:"file-select-button"},[d(i,{emoji:"ğŸ“",size:14}),e[24]||(e[24]=m(" íŒŒì¼ ì„ íƒ ",-1))]),l.effects.sfx?(c(),p("button",{key:0,onClick:e[5]||(e[5]=(...o)=>a.clearSfx&&a.clearSfx(...o)),class:"clear-button"},[d(i,{emoji:"âœ–ï¸",size:14})])):g("",!0)]),s("p",$,[d(i,{emoji:"ğŸ’¡",size:12}),e[25]||(e[25]=m(" ë¡œì»¬ íŒŒì¼ì€ base64ë¡œ ì¸ì½”ë”©ë˜ì–´ ì €ì¥ë©ë‹ˆë‹¤ (ì™¸ë¶€ í˜¸ìŠ¤íŒ… ë¶ˆí•„ìš”) ",-1))])]),s("div",ee,[s("h4",null,[d(i,{emoji:"ğŸµ",size:16}),e[26]||(e[26]=m(" ë°°ê²½ìŒì•… (BGM) ",-1))]),s("div",te,[f(s("input",{"onUpdate:modelValue":e[6]||(e[6]=o=>l.effects.bgm=o),type:"text",placeholder:"BGM URL (YouTube) ì…ë ¥ ë˜ëŠ” íŒŒì¼ ì„ íƒ ë²„íŠ¼ í´ë¦­",class:"url-input"},null,512),[[b,l.effects.bgm]]),s("input",{ref:"bgmFileInput",type:"file",accept:"audio/*",onChange:e[7]||(e[7]=(...o)=>a.handleBgmFileSelect&&a.handleBgmFileSelect(...o)),style:{display:"none"}},null,544),s("button",{onClick:e[8]||(e[8]=o=>t.$refs.bgmFileInput.click()),class:"file-select-button"},[d(i,{emoji:"ğŸ“",size:14}),e[27]||(e[27]=m(" íŒŒì¼ ì„ íƒ ",-1))]),l.effects.bgm?(c(),p("button",{key:0,onClick:e[9]||(e[9]=(...o)=>a.clearBgm&&a.clearBgm(...o)),class:"clear-button"},[d(i,{emoji:"âœ–ï¸",size:14})])):g("",!0)]),s("p",se,[d(i,{emoji:"ğŸ’¡",size:12}),e[28]||(e[28]=m(" ë¡œì»¬ íŒŒì¼ì€ base64ë¡œ ì¸ì½”ë”© | YouTube URL ì§€ì› ",-1))])]),s("div",le,[s("h4",null,[d(i,{emoji:"ğŸ–¼ï¸",size:16}),e[29]||(e[29]=m(" ë°°ê²½ ì´ë¯¸ì§€ ",-1))]),s("div",oe,[f(s("input",{"onUpdate:modelValue":e[10]||(e[10]=o=>l.effects.background=o),type:"text",placeholder:"ë°°ê²½ ì´ë¯¸ì§€ URL ì…ë ¥ ë˜ëŠ” íŒŒì¼ ì„ íƒ ë²„íŠ¼ í´ë¦­",class:"url-input"},null,512),[[b,l.effects.background]]),s("input",{ref:"bgFileInput",type:"file",accept:"image/*",onChange:e[11]||(e[11]=(...o)=>a.handleBgFileSelect&&a.handleBgFileSelect(...o)),style:{display:"none"}},null,544),s("button",{onClick:e[12]||(e[12]=o=>t.$refs.bgFileInput.click()),class:"file-select-button"},[d(i,{emoji:"ğŸ“",size:14}),e[30]||(e[30]=m(" íŒŒì¼ ì„ íƒ ",-1))]),l.effects.background?(c(),p("button",{key:0,onClick:e[13]||(e[13]=(...o)=>a.clearBackground&&a.clearBackground(...o)),class:"clear-button"},[d(i,{emoji:"âœ–ï¸",size:14})])):g("",!0)]),s("p",ae,[d(i,{emoji:"ğŸ’¡",size:12}),e[31]||(e[31]=m(" ë¡œì»¬ ì´ë¯¸ì§€ëŠ” base64ë¡œ ì¸ì½”ë”©ë˜ì–´ ì €ì¥ë©ë‹ˆë‹¤ ",-1))]),l.effects.background?(c(),p("div",ie,[s("label",null,[d(i,{emoji:"ğŸ’§",size:14}),m(" ë°°ê²½ íˆ¬ëª…ë„ ("+y(Math.round(l.effects.backgroundOpacity*100))+"%) ",1)]),f(s("input",{"onUpdate:modelValue":e[14]||(e[14]=o=>l.effects.backgroundOpacity=o),type:"range",min:"0",max:"1",step:"0.05",class:"opacity-slider"},null,512),[[b,l.effects.backgroundOpacity,void 0,{number:!0}]])])):g("",!0)]),s("div",re,[s("h4",null,[d(i,{emoji:"ğŸ–¼ï¸",size:16}),e[32]||(e[32]=m(" ì¼ëŸ¬ìŠ¤íŠ¸ ë²”ìœ„ ì ìš© ",-1))]),s("p",ne," í˜„ì¬ ì„ íƒëœ ìŠ¤í…ì˜ ì¼ëŸ¬ìŠ¤íŠ¸ ("+y(a.currentIllustrationsCount)+"ê°œ)ë¥¼ ì§€ì • ë²”ìœ„ì— ë®ì–´ì”ë‹ˆë‹¤. ",1)]),a.hasAnyEffect?(c(),p("div",de,[s("h4",null,[d(i,{emoji:"ğŸ‘ï¸",size:16}),e[33]||(e[33]=m(" ì„¤ì • ë¯¸ë¦¬ë³´ê¸° ",-1))]),s("div",ue,[l.effects.sfx?(c(),p("div",ce,[e[34]||(e[34]=s("strong",null,"íš¨ê³¼ìŒ:",-1)),s("span",null,y(a.formatPreviewUrl(l.effects.sfx)),1)])):g("",!0),l.effects.bgm?(c(),p("div",pe,[e[35]||(e[35]=s("strong",null,"BGM:",-1)),s("span",null,y(a.formatPreviewUrl(l.effects.bgm)),1)])):g("",!0),l.effects.background?(c(),p("div",he,[e[36]||(e[36]=s("strong",null,"ë°°ê²½:",-1)),s("span",null,y(a.formatPreviewUrl(l.effects.background)),1)])):g("",!0),l.effects.background?(c(),p("div",me,[e[37]||(e[37]=s("strong",null,"íˆ¬ëª…ë„:",-1)),s("span",null,y(Math.round(l.effects.backgroundOpacity*100))+"%",1)])):g("",!0)])])):g("",!0),s("div",fe,[s("button",{onClick:e[15]||(e[15]=(...o)=>a.applyEffects&&a.applyEffects(...o)),class:"apply-button",disabled:!a.canApply},[d(i,{emoji:"âœ…",size:16}),e[38]||(e[38]=m(" íš¨ê³¼ ì ìš© ",-1))],8,ge),s("button",{onClick:e[16]||(e[16]=(...o)=>a.applyIllustrationsRange&&a.applyIllustrationsRange(...o)),class:"illustration-button",disabled:!a.canApplyIllustrationsRange},[d(i,{emoji:"ğŸ–¼ï¸",size:16}),e[39]||(e[39]=m(" ì¼ëŸ¬ìŠ¤íŠ¸ ì ìš© ",-1))],8,ve),s("button",{onClick:e[17]||(e[17]=(...o)=>a.removeEffects&&a.removeEffects(...o)),class:"remove-button",disabled:!a.canApply},[d(i,{emoji:"ğŸ—‘ï¸",size:16}),e[40]||(e[40]=m(" íš¨ê³¼ ì œê±° ",-1))],8,be)])])])}const Ce=D(L,[["render",ye],["__scopeId","data-v-ccd5c34c"]]),Ve={name:"StepInfoEditor",props:{stepData:{type:Object,default:null}},data(){return{localData:null,showRawJSON:!1,illustFileInputs:[],isLoadingFile:!1}},computed:{hasDice(){var t,e;return((e=(t=this.localData)==null?void 0:t.diceRolls)==null?void 0:e.length)>0},hasStatusChange(){var t,e;return((e=(t=this.localData)==null?void 0:t.statusChanges)==null?void 0:e.length)>0},hasDXCombo(){var t,e;return((e=(t=this.localData)==null?void 0:t.dxCombos)==null?void 0:e.length)>0},hasIllustration(){var t,e;return((e=(t=this.localData)==null?void 0:t.illustrations)==null?void 0:e.length)>0},hasOugi(){var t,e;return((e=(t=this.localData)==null?void 0:t.ougis)==null?void 0:e.length)>0},hasShinobigami(){var t,e;return((e=(t=this.localData)==null?void 0:t.shinobigamis)==null?void 0:e.length)>0}},watch:{"localData.statusChanges":{handler(t){t&&t.forEach(e=>{e.oldValue!==null&&e.newValue!==null&&(e.delta=e.newValue-e.oldValue)})},deep:!0},"localData.diceRolls":{handler(t){t&&t.forEach(e=>{e.type==="choice"&&e.optionsText&&(e.options=e.optionsText.split(",").map(r=>r.trim()))})},deep:!0}},methods:{initializeLocalData(){var t,e,r;if(!this.stepData){this.localData=null;return}this.localData={id:this.stepData.id,sceneNumber:this.stepData.sceneNumber,type:this.stepData.type||"dialogue",character:{name:((t=this.stepData.character)==null?void 0:t.name)||"",color:((e=this.stepData.character)==null?void 0:e.color)||"#ffffff",avatarUrl:((r=this.stepData.character)==null?void 0:r.avatarUrl)||""},text:this.stepData.text||"",rawText:this.stepData.rawText||"",isSceneDescription:this.stepData.isSceneDescription||!1,sceneTitle:this.stepData.sceneTitle||"",scenePCs:this.stepData.scenePCs||"",sceneDescription:this.stepData.sceneDescription||"",illustrations:JSON.parse(JSON.stringify(this.stepData.illustrations||[])),diceRolls:this.initializeDiceRolls(this.stepData.diceRolls||[]),statusChanges:JSON.parse(JSON.stringify(this.stepData.statusChanges||[])),dxCombos:JSON.parse(JSON.stringify(this.stepData.dxCombos||[])),ougis:this.initializeOugis(this.stepData.ougis||[]),shinobigamis:JSON.parse(JSON.stringify(this.stepData.shinobigamis||[])),effects:JSON.parse(JSON.stringify(this.stepData.effects||{sfx:null,bgm:null,background:null,backgroundOpacity:.3}))}},initializeDiceRolls(t){return t.map(e=>{const r={...e};return e.type==="choice"&&e.options&&Array.isArray(e.options)&&(r.optionsText=e.options.join(", ")),r})},initializeOugis(t){return t.map(e=>{const r={...e};return e.skills&&Array.isArray(e.skills)&&(r.skills=e.skills.join(", ")),r})},addIllustration(){this.localData.illustrations||(this.localData.illustrations=[]),this.localData.illustrations.push({url:"",alt:"img"})},removeIllustration(t){this.localData.illustrations.splice(t,1)},handleImageError(t){t.target.style.display="none"},async handleIllustFileSelect(t,e){var l;const r=(l=t.target.files)==null?void 0:l[0];if(!r)return;const h=2*1024*1024;if(r.size>h){alert("ì´ë¯¸ì§€ íŒŒì¼ í¬ê¸°ëŠ” 2MB ì´í•˜ë¡œ ì œí•œë©ë‹ˆë‹¤."),t.target.value="";return}this.isLoadingFile=!0;try{const a=await this.fileToBase64(r);this.localData.illustrations[e].url=a}catch(a){console.error("[handleIllustFileSelect] íŒŒì¼ ë³€í™˜ ì‹¤íŒ¨:",a),alert("íŒŒì¼ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}finally{this.isLoadingFile=!1,t.target.value=""}},clearIllustration(t){this.localData.illustrations[t].url="",this.illustFileInputs[t]&&(this.illustFileInputs[t].value="")},async handleAvatarFileSelect(t){var h;const e=(h=t.target.files)==null?void 0:h[0];if(!e)return;const r=2*1024*1024;if(e.size>r){alert("ì•„ë°”íƒ€ ì´ë¯¸ì§€ íŒŒì¼ í¬ê¸°ëŠ” 2MB ì´í•˜ë¡œ ì œí•œë©ë‹ˆë‹¤."),t.target.value="";return}this.isLoadingFile=!0;try{const l=await this.fileToBase64(e);this.localData.character.avatarUrl=l}catch(l){console.error("[handleAvatarFileSelect] íŒŒì¼ ë³€í™˜ ì‹¤íŒ¨:",l),alert("íŒŒì¼ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}finally{this.isLoadingFile=!1,t.target.value=""}},clearAvatar(){this.localData.character.avatarUrl="",this.$refs.avatarFileInput&&(this.$refs.avatarFileInput.value="")},fileToBase64(t){return new Promise((e,r)=>{const h=new FileReader;h.onload=()=>e(h.result),h.onerror=r,h.readAsDataURL(t)})},addDiceRoll(){this.localData.diceRolls||(this.localData.diceRolls=[]),this.localData.diceRolls.push({type:"normal",formula:"",result:0,fullFormula:"",diceRolls:"",command:"",checkName:"",judgement:"",options:[],optionsText:""})},removeDiceRoll(t){this.localData.diceRolls.splice(t,1)},addStatusChange(){this.localData.statusChanges||(this.localData.statusChanges=[]),this.localData.statusChanges.push({characterName:"",statusName:"",oldValue:null,newValue:null,delta:0})},toggleStatusMode(t,e){e.target.checked?(t.oldValue=0,t.newValue=0,t.delta=0):(t.oldValue=null,t.newValue=null)},computeDelta(t){return t.oldValue!==null&&t.newValue!==null?t.newValue-t.oldValue:t.delta||0},removeStatusChange(t){this.localData.statusChanges.splice(t,1)},addDXCombo(){this.localData.dxCombos||(this.localData.dxCombos=[]),this.localData.dxCombos.push({type:"dx-combo",isSingleEffect:!1,comboName:"",description:"",effects:[],timing:"",difficulty:"",target:"",range:"",erosion:"",erosionCost:null,diceRoll:null})},removeDXCombo(t){this.localData.dxCombos.splice(t,1)},addOugi(){this.localData.ougis||(this.localData.ougis=[]),this.localData.ougis.push({type:"ougi",ougiName:"",skills:"",presentation:"",ougiEffect:"",ninpouInfo:"",ougiType:""})},removeOugi(t){this.localData.ougis.splice(t,1)},addShinobigami(){this.localData.shinobigamis||(this.localData.shinobigamis=[]),this.localData.shinobigamis.push({type:"shinobigami",command:"",checkName:"",formula:"",diceRolls:"",diceExpression:"",result:0,judgement:"",additionalInfo:null})},removeShinobigami(t){this.localData.shinobigamis.splice(t,1)},addShinobiAdditionalInfo(t){t.additionalInfo={type:"",range:"",cost:"",skill:"",description:""}},deleteStep(){!this.stepData||!confirm(`ìŠ¤í… #${this.stepData.id}ì„(ë¥¼) ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?
ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`)||this.$emit("delete",this.stepData.id)},duplicateStep(){this.stepData&&this.$emit("duplicate",this.stepData.id)},saveChanges(){if(!this.localData)return;const t={...this.localData,hasDice:this.hasDice,hasStatusChange:this.hasStatusChange,hasDXCombo:this.hasDXCombo,hasIllustration:this.hasIllustration,hasOugi:this.hasOugi,hasShinobigami:this.hasShinobigami};t.ougis&&(t.ougis=t.ougis.map(e=>({...e,skills:typeof e.skills=="string"?e.skills.split(/[,ã€]/).map(r=>r.trim()).filter(r=>r):e.skills}))),this.$emit("save",{id:this.stepData.id,updates:t})}},watch:{stepData:{immediate:!0,handler(){this.initializeLocalData(),this.showRawJSON=!1}}}},Se={class:"step-info-editor"},ke={class:"editor-header"},xe={class:"editor-body"},we={key:0,class:"no-selection"},Ue={key:1,class:"info-form"},Be={class:"field-group"},De=["value"],Ie={key:0,class:"field-group"},Te={key:1,class:"field-group"},_e={key:2,class:"field-group"},ze={class:"color-picker-wrapper"},je={key:3,class:"field-group"},Pe={class:"file-input-group"},Ee=["placeholder","readonly"],Re=["disabled"],Ne=["src"],Oe={key:4,class:"field-group"},Fe={key:5,class:"field-group"},Ae=["value"],Le={key:6,class:"field-group"},Me={class:"type-selection"},He={class:"radio-label"},Je={class:"radio-label"},Ge={class:"radio-label"},We={class:"radio-label"},Xe={key:7,class:"scene-desc-section"},qe={class:"field-group"},Ke={class:"field-label"},Ye={class:"field-row"},Qe={key:8,class:"field-group section-header"},Ze={class:"field-label"},$e={key:9,class:"items-list"},et={class:"item-content"},tt={class:"file-input-group"},st=["onUpdate:modelValue","placeholder","readonly"],lt=["onChange"],ot=["onClick","disabled"],at=["onClick"],it=["src"],rt=["onClick"],nt={key:10,class:"field-group section-header"},dt={class:"field-label"},ut={key:11,class:"items-list"},ct={class:"item-content"},pt={class:"field-row"},ht=["onUpdate:modelValue"],mt=["onUpdate:modelValue"],ft={key:0,class:"field-row"},gt=["onUpdate:modelValue"],vt={key:1,class:"dx3-fields"},bt={class:"field-row"},yt=["onUpdate:modelValue"],Ct={class:"field-row"},Vt=["onUpdate:modelValue"],St={class:"field-row"},kt=["onUpdate:modelValue"],xt={key:2,class:"judgement-fields"},wt={class:"field-row"},Ut=["onUpdate:modelValue"],Bt=["onUpdate:modelValue"],Dt={class:"field-row"},It=["onUpdate:modelValue"],Tt=["onUpdate:modelValue"],_t={key:3,class:"choice-fields"},zt={class:"field-row"},jt=["onUpdate:modelValue"],Pt={class:"field-row"},Et=["onUpdate:modelValue"],Rt=["onClick"],Nt={key:12,class:"field-group section-header"},Ot={class:"field-label"},Ft={key:13,class:"items-list"},At={class:"item-content"},Lt={class:"field-row"},Mt=["onUpdate:modelValue"],Ht=["onUpdate:modelValue"],Jt={class:"field-row"},Gt={class:"checkbox-label"},Wt=["checked","onChange"],Xt={key:0,class:"field-row"},qt=["onUpdate:modelValue"],Kt=["onUpdate:modelValue"],Yt={key:1,class:"field-row"},Qt=["onUpdate:modelValue"],Zt=["onClick"],$t={key:14,class:"field-group section-header"},es={class:"field-label"},ts={key:15,class:"items-list"},ss={class:"item-content"},ls=["onUpdate:modelValue"],os=["onUpdate:modelValue"],as=["onUpdate:modelValue"],is=["onUpdate:modelValue"],rs=["onUpdate:modelValue"],ns=["onUpdate:modelValue"],ds=["onClick"],us={key:16,class:"field-group section-header"},cs={class:"field-label"},ps={key:17,class:"items-list"},hs={class:"item-content"},ms={class:"field-row"},fs=["onUpdate:modelValue"],gs=["onUpdate:modelValue"],vs={class:"field-row"},bs=["onUpdate:modelValue"],ys=["onUpdate:modelValue"],Cs={class:"field-row"},Vs=["onUpdate:modelValue"],Ss=["onUpdate:modelValue"],ks={key:0,class:"shinobi-additional-info"},xs={class:"field-row"},ws=["onUpdate:modelValue"],Us=["onUpdate:modelValue"],Bs=["onUpdate:modelValue"],Ds=["onUpdate:modelValue"],Is=["onUpdate:modelValue"],Ts=["onClick"],_s=["onClick"],zs={key:18,class:"field-group section-header"},js={class:"field-label"},Ps={key:19,class:"items-list"},Es={class:"item-content"},Rs={class:"field-row"},Ns=["onUpdate:modelValue"],Os={class:"checkbox-label"},Fs=["onUpdate:modelValue"],As=["onUpdate:modelValue"],Ls={class:"field-row"},Ms=["onUpdate:modelValue"],Hs=["onUpdate:modelValue"],Js={class:"field-row"},Gs=["onUpdate:modelValue"],Ws=["onUpdate:modelValue"],Xs=["onUpdate:modelValue"],qs={class:"field-row"},Ks=["onUpdate:modelValue"],Ys=["onUpdate:modelValue"],Qs=["onClick"],Zs={key:20,class:"field-group"},$s={class:"field-label"},el={key:21,class:"json-viewer"},tl={key:22,class:"actions"},sl={class:"action-group left"};function ll(t,e,r,h,l,a){const i=x("EmojiToIcon");return c(),p("div",Se,[s("div",ke,[s("h3",null,[d(i,{emoji:"ğŸ“",size:20}),e[29]||(e[29]=m(" ìŠ¤í… ì •ë³´ í¸ì§‘ê¸° ",-1))])]),s("div",xe,[r.stepData?(c(),p("div",Ue,[s("div",Be,[e[31]||(e[31]=s("label",{class:"field-label"},"ìŠ¤í… ID (ì½ê¸° ì „ìš©)",-1)),s("input",{type:"text",value:r.stepData.id,disabled:"",class:"field-input disabled"},null,8,De)]),l.localData?(c(),p("div",Ie,[e[32]||(e[32]=s("label",{class:"field-label"},"ì”¬ ë²ˆí˜¸",-1)),f(s("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>l.localData.sceneNumber=o),type:"number",class:"field-input",placeholder:"ì”¬ ë²ˆí˜¸"},null,512),[[b,l.localData.sceneNumber,void 0,{number:!0}]])])):g("",!0),l.localData?(c(),p("div",Te,[e[33]||(e[33]=s("label",{class:"field-label"},"ìºë¦­í„° ì´ë¦„",-1)),f(s("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>l.localData.character.name=o),type:"text",class:"field-input",placeholder:"ìºë¦­í„° ì´ë¦„"},null,512),[[b,l.localData.character.name]])])):g("",!0),l.localData?(c(),p("div",_e,[e[34]||(e[34]=s("label",{class:"field-label"},"ìºë¦­í„° ìƒ‰ìƒ",-1)),s("div",ze,[f(s("input",{"onUpdate:modelValue":e[2]||(e[2]=o=>l.localData.character.color=o),type:"color",class:"color-picker"},null,512),[[b,l.localData.character.color]]),f(s("input",{"onUpdate:modelValue":e[3]||(e[3]=o=>l.localData.character.color=o),type:"text",class:"color-input",placeholder:"#ffffff"},null,512),[[b,l.localData.character.color]])])])):g("",!0),l.localData?(c(),p("div",je,[e[35]||(e[35]=s("label",{class:"field-label"},"ì•„ë°”íƒ€ URL",-1)),s("div",Pe,[f(s("input",{"onUpdate:modelValue":e[4]||(e[4]=o=>l.localData.character.avatarUrl=o),type:"text",class:"field-input",placeholder:l.localData.character.avatarUrl&&l.localData.character.avatarUrl.startsWith("data:image")?"[ë¡œì»¬ ì•„ë°”íƒ€ íŒŒì¼]":"https://example.com/avatar.png ë˜ëŠ” íŒŒì¼ ì„ íƒ",readonly:l.localData.character.avatarUrl&&l.localData.character.avatarUrl.startsWith("data:image")},null,8,Ee),[[b,l.localData.character.avatarUrl]]),s("input",{type:"file",ref:"avatarFileInput",accept:"image/*",style:{display:"none"},onChange:e[5]||(e[5]=(...o)=>a.handleAvatarFileSelect&&a.handleAvatarFileSelect(...o))},null,544),s("button",{onClick:e[6]||(e[6]=o=>{var v;return(v=t.$refs.avatarFileInput)==null?void 0:v.click()}),class:"file-select-button",disabled:l.isLoadingFile},[d(i,{emoji:"ğŸ“",size:14}),m(" "+y(l.isLoadingFile?"ë¡œë”©...":"íŒŒì¼"),1)],8,Re),l.localData.character.avatarUrl?(c(),p("button",{key:0,onClick:e[7]||(e[7]=(...o)=>a.clearAvatar&&a.clearAvatar(...o)),class:"clear-button",title:"ì´ˆê¸°í™”"},[d(i,{emoji:"âœ–ï¸",size:12})])):g("",!0)]),e[36]||(e[36]=s("p",{class:"hint-text"},"ì•„ë°”íƒ€ ì´ë¯¸ì§€ ê¶Œì¥ í¬ê¸°: 2MB ì´í•˜",-1)),l.localData.character.avatarUrl?(c(),p("img",{key:0,src:l.localData.character.avatarUrl,class:"preview-img avatar-preview",onError:e[8]||(e[8]=(...o)=>a.handleImageError&&a.handleImageError(...o))},null,40,Ne)):g("",!0)])):g("",!0),l.localData?(c(),p("div",Oe,[e[37]||(e[37]=s("label",{class:"field-label"},"ëŒ€ì‚¬ í…ìŠ¤íŠ¸",-1)),f(s("textarea",{"onUpdate:modelValue":e[9]||(e[9]=o=>l.localData.text=o),class:"field-textarea",rows:"4",placeholder:"ìºë¦­í„°ì˜ ëŒ€ì‚¬ë¥¼ ì…ë ¥í•˜ì„¸ìš”"},null,512),[[b,l.localData.text]])])):g("",!0),r.stepData?(c(),p("div",Fe,[e[38]||(e[38]=s("label",{class:"field-label"},"ì›ë³¸ í…ìŠ¤íŠ¸ (ì½ê¸° ì „ìš©)",-1)),s("textarea",{value:r.stepData.rawText,disabled:"",class:"field-textarea disabled",rows:"3"},null,8,Ae)])):g("",!0),l.localData?(c(),p("div",Le,[e[43]||(e[43]=s("label",{class:"field-label"},"ìŠ¤í… íƒ€ì… (í•˜ë‚˜ë§Œ ì„ íƒ ê°€ëŠ¥)",-1)),s("div",Me,[s("label",He,[f(s("input",{type:"radio",value:"dialogue","onUpdate:modelValue":e[10]||(e[10]=o=>l.localData.type=o)},null,512),[[T,l.localData.type]]),e[39]||(e[39]=s("span",null,"ì¼ë°˜ ëŒ€í™”",-1))]),s("label",Je,[f(s("input",{type:"radio",value:"system","onUpdate:modelValue":e[11]||(e[11]=o=>l.localData.type=o)},null,512),[[T,l.localData.type]]),e[40]||(e[40]=s("span",null,"ì‹œìŠ¤í…œ ë©”ì‹œì§€",-1))]),s("label",Ge,[f(s("input",{type:"radio",value:"narrator","onUpdate:modelValue":e[12]||(e[12]=o=>l.localData.type=o)},null,512),[[T,l.localData.type]]),e[41]||(e[41]=s("span",null,"ë‚˜ë ˆì´í„°",-1))]),s("label",We,[f(s("input",{type:"radio",value:"scene-description","onUpdate:modelValue":e[13]||(e[13]=o=>l.localData.type=o)},null,512),[[T,l.localData.type]]),e[42]||(e[42]=s("span",null,"ì”¬ ì„¤ëª…",-1))])])])):g("",!0),l.localData&&l.localData.type==="scene-description"?(c(),p("div",Xe,[s("div",qe,[s("label",Ke,[d(i,{emoji:"ğŸ¬",size:14}),e[44]||(e[44]=m(" ì”¬ ì •ë³´ ",-1))])]),s("div",Ye,[f(s("input",{"onUpdate:modelValue":e[14]||(e[14]=o=>l.localData.sceneNumber=o),type:"text",class:"field-input small",placeholder:"ì”¬ ë²ˆí˜¸"},null,512),[[b,l.localData.sceneNumber]]),f(s("input",{"onUpdate:modelValue":e[15]||(e[15]=o=>l.localData.sceneTitle=o),type:"text",class:"field-input",placeholder:"ì”¬ ì œëª©"},null,512),[[b,l.localData.sceneTitle]])]),f(s("input",{"onUpdate:modelValue":e[16]||(e[16]=o=>l.localData.scenePCs=o),type:"text",class:"field-input",placeholder:"ì°¸ê°€ PC (ì˜ˆ: í™ê¸¸ë™, ê¹€ì² ìˆ˜)"},null,512),[[b,l.localData.scenePCs]]),f(s("textarea",{"onUpdate:modelValue":e[17]||(e[17]=o=>l.localData.sceneDescription=o),class:"field-textarea",rows:"3",placeholder:"ì”¬ ìƒì„¸ ì„¤ëª…"},null,512),[[b,l.localData.sceneDescription]])])):g("",!0),l.localData?(c(),p("div",Qe,[s("label",Ze,[d(i,{emoji:"ğŸ–¼ï¸",size:14}),m(" ì¼ëŸ¬ìŠ¤íŠ¸ ("+y(l.localData.illustrations.length)+"ê°œ) ",1)]),s("button",{onClick:e[18]||(e[18]=(...o)=>a.addIllustration&&a.addIllustration(...o)),class:"add-button"},[d(i,{emoji:"â•",size:12}),e[45]||(e[45]=m(" ì¶”ê°€ ",-1))])])):g("",!0),l.localData.illustrations.length>0?(c(),p("div",$e,[(c(!0),p(k,null,U(l.localData.illustrations,(o,v)=>(c(),p("div",{key:v,class:"item-card"},[s("div",et,[s("div",tt,[f(s("input",{"onUpdate:modelValue":n=>o.url=n,type:"text",class:"field-input",placeholder:o.url&&o.url.startsWith("data:image")?"[ë¡œì»¬ ì´ë¯¸ì§€ íŒŒì¼]":"ì´ë¯¸ì§€ URL ë˜ëŠ” íŒŒì¼ ì„ íƒ",readonly:o.url&&o.url.startsWith("data:image")},null,8,st),[[b,o.url]]),s("input",{type:"file",ref_for:!0,ref:n=>{n&&(l.illustFileInputs[v]=n)},accept:"image/*",style:{display:"none"},onChange:n=>a.handleIllustFileSelect(n,v)},null,40,lt),s("button",{onClick:()=>{var n;return(n=l.illustFileInputs[v])==null?void 0:n.click()},class:"file-select-button",disabled:l.isLoadingFile},[d(i,{emoji:"ğŸ“",size:14}),m(" "+y(l.isLoadingFile?"ë¡œë”©...":"íŒŒì¼"),1)],8,ot),o.url?(c(),p("button",{key:0,onClick:()=>a.clearIllustration(v),class:"clear-button",title:"ì´ˆê¸°í™”"},[d(i,{emoji:"âœ–ï¸",size:12})],8,at)):g("",!0)]),e[46]||(e[46]=s("p",{class:"hint-text"},"ì´ë¯¸ì§€ íŒŒì¼ ê¶Œì¥ í¬ê¸°: 2MB ì´í•˜",-1)),o.url?(c(),p("img",{key:0,src:o.url,class:"preview-img",onError:e[19]||(e[19]=(...n)=>a.handleImageError&&a.handleImageError(...n))},null,40,it)):g("",!0)]),s("button",{onClick:n=>a.removeIllustration(v),class:"remove-button"},[d(i,{emoji:"ğŸ—‘ï¸",size:14})],8,rt)]))),128))])):g("",!0),l.localData?(c(),p("div",nt,[s("label",dt,[d(i,{emoji:"ğŸ²",size:14}),m(" ë‹¤ì´ìŠ¤ ë¡¤ ("+y(l.localData.diceRolls.length)+"ê°œ) ",1)]),s("button",{onClick:e[20]||(e[20]=(...o)=>a.addDiceRoll&&a.addDiceRoll(...o)),class:"add-button"},[d(i,{emoji:"â•",size:12}),e[47]||(e[47]=m(" ì¶”ê°€ ",-1))])])):g("",!0),l.localData.diceRolls.length>0?(c(),p("div",ut,[(c(!0),p(k,null,U(l.localData.diceRolls,(o,v)=>(c(),p("div",{key:v,class:"item-card dice-card"},[s("div",ct,[s("div",pt,[f(s("select",{"onUpdate:modelValue":n=>o.type=n,class:"field-input small"},[...e[48]||(e[48]=[s("option",{value:"normal"},"ì¼ë°˜",-1),s("option",{value:"dx3"},"DX3",-1),s("option",{value:"judgement"},"íŒì •",-1),s("option",{value:"choice"},"ì„ íƒ",-1)])],8,ht),[[z,o.type]]),f(s("input",{"onUpdate:modelValue":n=>o.formula=n,type:"text",class:"field-input",placeholder:"ê³µì‹ (ì˜ˆ: 1D100, 8dx+16)"},null,8,mt),[[b,o.formula]])]),o.type==="normal"?(c(),p("div",ft,[e[49]||(e[49]=s("span",{class:"field-label-inline"},"ê²°ê³¼:",-1)),f(s("input",{"onUpdate:modelValue":n=>o.result=n,type:"number",class:"field-input small",placeholder:"ê²°ê³¼"},null,8,gt),[[b,o.result,void 0,{number:!0}]])])):g("",!0),o.type==="dx3"?(c(),p("div",vt,[s("div",bt,[f(s("input",{"onUpdate:modelValue":n=>o.fullFormula=n,type:"text",class:"field-input",placeholder:"ì „ì²´ ê³µì‹ (ì˜ˆ: 8DX10+16)"},null,8,yt),[[b,o.fullFormula]])]),s("div",Ct,[f(s("input",{"onUpdate:modelValue":n=>o.diceRolls=n,type:"text",class:"field-input",placeholder:"ë‹¤ì´ìŠ¤ ë¡¤ (ì˜ˆ: 10[5,6,7,8,9,10]+5[5]+16)"},null,8,Vt),[[b,o.diceRolls]])]),s("div",St,[e[50]||(e[50]=s("span",{class:"field-label-inline"},"ìµœì¢… ê²°ê³¼:",-1)),f(s("input",{"onUpdate:modelValue":n=>o.result=n,type:"number",class:"field-input small",placeholder:"ê²°ê³¼"},null,8,kt),[[b,o.result,void 0,{number:!0}]])])])):g("",!0),o.type==="judgement"?(c(),p("div",xt,[s("div",wt,[f(s("input",{"onUpdate:modelValue":n=>o.command=n,type:"text",class:"field-input small",placeholder:"ì»¤ë§¨ë“œ (cc<=70)"},null,8,Ut),[[b,o.command]]),f(s("input",{"onUpdate:modelValue":n=>o.checkName=n,type:"text",class:"field-input",placeholder:"íŒì •ëª…"},null,8,Bt),[[b,o.checkName]])]),s("div",Dt,[f(s("input",{"onUpdate:modelValue":n=>o.result=n,type:"number",class:"field-input small",placeholder:"ê²°ê³¼"},null,8,It),[[b,o.result,void 0,{number:!0}]]),f(s("input",{"onUpdate:modelValue":n=>o.judgement=n,type:"text",class:"field-input",placeholder:"íŒì • (ë³´í†µ ì„±ê³µ, ì‹¤íŒ¨ ë“±)"},null,8,Tt),[[b,o.judgement]])])])):g("",!0),o.type==="choice"?(c(),p("div",_t,[s("div",zt,[f(s("textarea",{"onUpdate:modelValue":n=>o.optionsText=n,class:"field-textarea small",rows:"2",placeholder:"ì„ íƒì§€ (ì‰¼í‘œë¡œ êµ¬ë¶„)"},null,8,jt),[[b,o.optionsText]])]),s("div",Pt,[e[51]||(e[51]=s("span",{class:"field-label-inline"},"ì„ íƒë¨:",-1)),f(s("input",{"onUpdate:modelValue":n=>o.result=n,type:"text",class:"field-input",placeholder:"ì„ íƒëœ ì˜µì…˜"},null,8,Et),[[b,o.result]])])])):g("",!0)]),s("button",{onClick:n=>a.removeDiceRoll(v),class:"remove-button"},[d(i,{emoji:"ğŸ—‘ï¸",size:14})],8,Rt)]))),128))])):g("",!0),l.localData?(c(),p("div",Nt,[s("label",Ot,[d(i,{emoji:"ğŸ“Š",size:14}),m(" ìŠ¤í…Œì´í„°ìŠ¤ ë³€í™” ("+y(l.localData.statusChanges.length)+"ê°œ) ",1)]),s("button",{onClick:e[21]||(e[21]=(...o)=>a.addStatusChange&&a.addStatusChange(...o)),class:"add-button"},[d(i,{emoji:"â•",size:12}),e[52]||(e[52]=m(" ì¶”ê°€ ",-1))])])):g("",!0),l.localData.statusChanges.length>0?(c(),p("div",Ft,[(c(!0),p(k,null,U(l.localData.statusChanges,(o,v)=>(c(),p("div",{key:v,class:"item-card"},[s("div",At,[s("div",Lt,[f(s("input",{"onUpdate:modelValue":n=>o.characterName=n,type:"text",class:"field-input",placeholder:"ìºë¦­í„°ëª…"},null,8,Mt),[[b,o.characterName]]),f(s("input",{"onUpdate:modelValue":n=>o.statusName=n,type:"text",class:"field-input",placeholder:"ìƒíƒœëª… (HP, ì¹¨ì‹ë¥  ë“±)"},null,8,Ht),[[b,o.statusName]])]),s("div",Jt,[s("label",Gt,[s("input",{type:"checkbox",checked:o.oldValue!==null&&o.newValue!==null,onChange:n=>a.toggleStatusMode(o,n)},null,40,Wt),e[53]||(e[53]=s("span",null,"ì´ì „ê°’/ìƒˆê°’ ëª¨ë“œ",-1))])]),o.oldValue!==null&&o.newValue!==null?(c(),p("div",Xt,[f(s("input",{"onUpdate:modelValue":n=>o.oldValue=n,type:"number",class:"field-input small",placeholder:"ì´ì „ê°’"},null,8,qt),[[b,o.oldValue,void 0,{number:!0}]]),e[54]||(e[54]=s("span",{class:"arrow"},"â†’",-1)),f(s("input",{"onUpdate:modelValue":n=>o.newValue=n,type:"number",class:"field-input small",placeholder:"ìƒˆê°’"},null,8,Kt),[[b,o.newValue,void 0,{number:!0}]]),s("span",{class:w(["delta",{positive:a.computeDelta(o)>0,negative:a.computeDelta(o)<0}])},y(a.computeDelta(o)>0?"+":"")+y(a.computeDelta(o)),3)])):(c(),p("div",Yt,[e[55]||(e[55]=s("span",{class:"field-label-inline"},"ë³€í™”ëŸ‰:",-1)),f(s("input",{"onUpdate:modelValue":n=>o.delta=n,type:"number",class:"field-input small",placeholder:"Â±ë³€í™”ëŸ‰"},null,8,Qt),[[b,o.delta,void 0,{number:!0}]]),s("span",{class:w(["delta",{positive:o.delta>0,negative:o.delta<0}])},y(o.delta>0?"+":"")+y(o.delta),3)]))]),s("button",{onClick:n=>a.removeStatusChange(v),class:"remove-button"},[d(i,{emoji:"ğŸ—‘ï¸",size:14})],8,Zt)]))),128))])):g("",!0),l.localData?(c(),p("div",$t,[s("label",es,[d(i,{emoji:"ğŸŒŸ",size:14}),m(" ì‹œë…¸ë¹„ê°€ë¯¸ ì˜¤ì˜ ("+y((l.localData.ougis||[]).length)+"ê°œ) ",1)]),s("button",{onClick:e[22]||(e[22]=(...o)=>a.addOugi&&a.addOugi(...o)),class:"add-button"},[d(i,{emoji:"â•",size:12}),e[56]||(e[56]=m(" ì¶”ê°€ ",-1))])])):g("",!0),(l.localData.ougis||[]).length>0?(c(),p("div",ts,[(c(!0),p(k,null,U(l.localData.ougis,(o,v)=>(c(),p("div",{key:v,class:"item-card ougi-card"},[s("div",ss,[f(s("input",{"onUpdate:modelValue":n=>o.ougiName=n,type:"text",class:"field-input",placeholder:"ì˜¤ì˜ëª… (ì˜ˆ: ì „ìŸì˜ ì§•ì¡°)"},null,8,ls),[[b,o.ougiName]]),f(s("input",{"onUpdate:modelValue":n=>o.skills=n,type:"text",class:"field-input",placeholder:"ì§€ì • íŠ¹ê¸° (ì‰¼í‘œ êµ¬ë¶„, ì˜ˆ: ë„ê²€ìˆ , ì¸ë§¥)"},null,8,os),[[b,o.skills]]),f(s("textarea",{"onUpdate:modelValue":n=>o.presentation=n,class:"field-textarea small",rows:"2",placeholder:"ì—°ì¶œ (ì˜¤ì˜ ì‚¬ìš© ì‹œ ë¬˜ì‚¬)"},null,8,as),[[b,o.presentation]]),f(s("textarea",{"onUpdate:modelValue":n=>o.ougiEffect=n,class:"field-textarea small",rows:"2",placeholder:"ì˜¤ì˜ íš¨ê³¼ (ì „íˆ¬ì—ì„œì˜ íš¨ê³¼ ë“±, ì„ íƒì‚¬í•­)"},null,8,is),[[b,o.ougiEffect]]),f(s("input",{"onUpdate:modelValue":n=>o.ninpouInfo=n,type:"text",class:"field-input",placeholder:"ì¸ë²• ì •ë³´ (ì˜ˆ: ë§ºìŒ/í¬ë‚˜í° ë¶„ë…¸)"},null,8,rs),[[b,o.ninpouInfo]]),f(s("input",{"onUpdate:modelValue":n=>o.ougiType=n,type:"text",class:"field-input",placeholder:"ì˜¤ì˜ ì¢…ë¥˜ (ì˜ˆ: ì „ìŸì˜ ì‹ , ì ˆëŒ€ ë°©ì–´)"},null,8,ns),[[b,o.ougiType]])]),s("button",{onClick:n=>a.removeOugi(v),class:"remove-button"},[d(i,{emoji:"ğŸ—‘ï¸",size:14})],8,ds)]))),128))])):g("",!0),l.localData?(c(),p("div",us,[s("label",cs,[d(i,{emoji:"âš”ï¸",size:14}),m(" ì‹œë…¸ë¹„ê°€ë¯¸ ì¸ë²• ("+y((l.localData.shinobigamis||[]).length)+"ê°œ) ",1)]),s("button",{onClick:e[23]||(e[23]=(...o)=>a.addShinobigami&&a.addShinobigami(...o)),class:"add-button"},[d(i,{emoji:"â•",size:12}),e[57]||(e[57]=m(" ì¶”ê°€ ",-1))])])):g("",!0),(l.localData.shinobigamis||[]).length>0?(c(),p("div",ps,[(c(!0),p(k,null,U(l.localData.shinobigamis,(o,v)=>(c(),p("div",{key:v,class:"item-card shinobi-card"},[s("div",hs,[s("div",ms,[f(s("input",{"onUpdate:modelValue":n=>o.command=n,type:"text",class:"field-input small",placeholder:"ëª…ë ¹ì–´ (ì˜ˆ: SG@12#2>=5)"},null,8,fs),[[b,o.command]]),f(s("input",{"onUpdate:modelValue":n=>o.checkName=n,type:"text",class:"field-input",placeholder:"íŒì •ëª… (ì˜ˆ: ë„ê²€ìˆ , ê´´ë ¥)"},null,8,gs),[[b,o.checkName]])]),s("div",vs,[f(s("input",{"onUpdate:modelValue":n=>o.diceRolls=n,type:"text",class:"field-input small",placeholder:"ì£¼ì‚¬ìœ„ (ì˜ˆ: 1,2)"},null,8,bs),[[b,o.diceRolls]]),f(s("input",{"onUpdate:modelValue":n=>o.diceExpression=n,type:"text",class:"field-input",placeholder:"ë‹¤ì´ìŠ¤ í‘œí˜„ (ì˜ˆ: 3[1,2])"},null,8,ys),[[b,o.diceExpression]])]),s("div",Cs,[f(s("input",{"onUpdate:modelValue":n=>o.result=n,type:"number",class:"field-input small",placeholder:"ê²°ê³¼"},null,8,Vs),[[b,o.result,void 0,{number:!0}]]),f(s("input",{"onUpdate:modelValue":n=>o.judgement=n,type:"text",class:"field-input small",placeholder:"íŒì • (æˆåŠŸ/å¤±æ•—)"},null,8,Ss),[[b,o.judgement]])]),o.additionalInfo?(c(),p("div",ks,[s("div",xs,[f(s("input",{"onUpdate:modelValue":n=>o.additionalInfo.type=n,type:"text",class:"field-input small",placeholder:"íƒ€ì…"},null,8,ws),[[b,o.additionalInfo.type]]),f(s("input",{"onUpdate:modelValue":n=>o.additionalInfo.range=n,type:"text",class:"field-input small",placeholder:"ì‚¬ê±°ë¦¬"},null,8,Us),[[b,o.additionalInfo.range]]),f(s("input",{"onUpdate:modelValue":n=>o.additionalInfo.cost=n,type:"text",class:"field-input small",placeholder:"ì½”ìŠ¤íŠ¸"},null,8,Bs),[[b,o.additionalInfo.cost]])]),f(s("input",{"onUpdate:modelValue":n=>o.additionalInfo.skill=n,type:"text",class:"field-input",placeholder:"íŠ¹ê¸°"},null,8,Ds),[[b,o.additionalInfo.skill]]),f(s("textarea",{"onUpdate:modelValue":n=>o.additionalInfo.description=n,class:"field-textarea small",rows:"2",placeholder:"ì„¤ëª…"},null,8,Is),[[b,o.additionalInfo.description]])])):(c(),p("button",{key:1,onClick:n=>a.addShinobiAdditionalInfo(o),class:"add-info-button"},[d(i,{emoji:"â•",size:10}),e[58]||(e[58]=m(" ì¶”ê°€ ì •ë³´ ì…ë ¥ ",-1))],8,Ts))]),s("button",{onClick:n=>a.removeShinobigami(v),class:"remove-button"},[d(i,{emoji:"ğŸ—‘ï¸",size:14})],8,_s)]))),128))])):g("",!0),l.localData?(c(),p("div",zs,[s("label",js,[d(i,{emoji:"âš”ï¸",size:14}),m(" DX ì½¤ë³´/ì´í™íŠ¸ ("+y(l.localData.dxCombos.length)+"ê°œ) ",1)]),s("button",{onClick:e[24]||(e[24]=(...o)=>a.addDXCombo&&a.addDXCombo(...o)),class:"add-button"},[d(i,{emoji:"â•",size:12}),e[59]||(e[59]=m(" ì¶”ê°€ ",-1))])])):g("",!0),l.localData.dxCombos.length>0?(c(),p("div",Ps,[(c(!0),p(k,null,U(l.localData.dxCombos,(o,v)=>(c(),p("div",{key:v,class:"item-card combo-card"},[s("div",Es,[s("div",Rs,[f(s("select",{"onUpdate:modelValue":n=>o.type=n,class:"field-input small"},[...e[60]||(e[60]=[s("option",{value:"dx-combo"},"ì½¤ë³´",-1),s("option",{value:"dx-effect"},"ë‹¨ì¼ ì´í™íŠ¸",-1)])],8,Ns),[[z,o.type]]),s("label",Os,[f(s("input",{type:"checkbox","onUpdate:modelValue":n=>o.isSingleEffect=n},null,8,Fs),[[P,o.isSingleEffect]]),e[61]||(e[61]=s("span",null,"ë‹¨ì¼ ì´í™íŠ¸",-1))])]),f(s("input",{"onUpdate:modelValue":n=>o.comboName=n,type:"text",class:"field-input",placeholder:"ì½¤ë³´/ì´í™íŠ¸ëª…"},null,8,As),[[b,o.comboName]]),s("div",Ls,[f(s("input",{"onUpdate:modelValue":n=>o.timing=n,type:"text",class:"field-input",placeholder:"íƒ€ì´ë° (ë©”ì´ì €, ë§ˆì´ë„ˆ ë“±)"},null,8,Ms),[[b,o.timing]]),f(s("input",{"onUpdate:modelValue":n=>o.difficulty=n,type:"text",class:"field-input",placeholder:"ë‚œì´ë„ (ìë™, ëŒ€í•­ ë“±)"},null,8,Hs),[[b,o.difficulty]])]),s("div",Js,[f(s("input",{"onUpdate:modelValue":n=>o.target=n,type:"text",class:"field-input",placeholder:"ëŒ€ìƒ"},null,8,Gs),[[b,o.target]]),f(s("input",{"onUpdate:modelValue":n=>o.range=n,type:"text",class:"field-input",placeholder:"ì‚¬ê±°ë¦¬"},null,8,Ws),[[b,o.range]])]),f(s("textarea",{"onUpdate:modelValue":n=>o.description=n,class:"field-textarea small",rows:"2",placeholder:"ì„¤ëª…/ê¸°ëŠ¥"},null,8,Xs),[[b,o.description]]),s("div",qs,[f(s("input",{"onUpdate:modelValue":n=>o.erosion=n,type:"text",class:"field-input small",placeholder:"ì¹¨ì‹ì¹˜"},null,8,Ks),[[b,o.erosion]]),f(s("input",{"onUpdate:modelValue":n=>o.erosionCost=n,type:"number",class:"field-input small",placeholder:"ì¹¨ì‹ ì½”ìŠ¤íŠ¸"},null,8,Ys),[[b,o.erosionCost,void 0,{number:!0}]])])]),s("button",{onClick:n=>a.removeDXCombo(v),class:"remove-button"},[d(i,{emoji:"ğŸ—‘ï¸",size:14})],8,Qs)]))),128))])):g("",!0),r.stepData?(c(),p("div",Zs,[s("label",$s,[d(i,{emoji:"ğŸ”",size:14}),e[62]||(e[62]=m(" JSON ì›ë³¸ ë°ì´í„° ",-1))]),s("button",{onClick:e[25]||(e[25]=o=>l.showRawJSON=!l.showRawJSON),class:"toggle-json-button"},y(l.showRawJSON?"ìˆ¨ê¸°ê¸°":"ë³´ê¸°"),1)])):g("",!0),l.showRawJSON?(c(),p("div",el,[s("pre",null,y(JSON.stringify(r.stepData,null,2)),1)])):g("",!0),l.localData?(c(),p("div",tl,[s("div",sl,[s("button",{onClick:e[26]||(e[26]=(...o)=>a.deleteStep&&a.deleteStep(...o)),class:"delete-button"},[d(i,{emoji:"ğŸ—‘ï¸",size:16}),e[63]||(e[63]=m(" ìŠ¤í… ì‚­ì œ ",-1))]),s("button",{onClick:e[27]||(e[27]=(...o)=>a.duplicateStep&&a.duplicateStep(...o)),class:"duplicate-button"},[d(i,{emoji:"ğŸ“‹",size:16}),e[64]||(e[64]=m(" ìŠ¤í… ë³µì‚¬ ",-1))])]),s("button",{onClick:e[28]||(e[28]=(...o)=>a.saveChanges&&a.saveChanges(...o)),class:"save-button"},[d(i,{emoji:"ğŸ’¾",size:16}),e[65]||(e[65]=m(" ë³€ê²½ì‚¬í•­ ì €ì¥ ",-1))])])):g("",!0)])):(c(),p("div",we,[d(i,{emoji:"ğŸ‘†",size:48}),e[30]||(e[30]=s("p",null,"ì™¼ìª½ì—ì„œ ìŠ¤í…ì„ ì„ íƒí•˜ì„¸ìš”",-1))]))])])}const ol=D(Ve,[["render",ll],["__scopeId","data-v-a8f9f26d"]]),al={name:"CharacterBulkEditor",props:{allSteps:{type:Array,required:!0}},data(){return{selectedCharacter:null,newCharacterName:"",newCharacterColor:"",convertToNarrator:!1,narratorConfirmAcknowledged:!1,showNarratorConfirm:!1,isApplying:!1,progressCurrent:0,progressTotal:0}},computed:{characterGroups(){const t={};return this.allSteps.forEach(e=>{var i,o,v;const r=((i=e.character)==null?void 0:i.name)||"",h=((o=e.character)==null?void 0:o.color)||"#ffffff",l=((v=e.character)==null?void 0:v.avatarUrl)||null,a=e.type==="narrator";t[r]||(t[r]={name:r,color:h,avatarUrl:null,count:0,nonNarratorCount:0}),t[r].count++,a||t[r].nonNarratorCount++,!t[r].avatarUrl&&l&&(t[r].avatarUrl=l)}),Object.values(t).filter(e=>e.nonNarratorCount>0).sort((e,r)=>r.count-e.count)},selectedGroup(){return this.selectedCharacter?this.characterGroups.find(t=>t.name===this.selectedCharacter):null},hasChanges(){if(!this.selectedCharacter)return!1;const t=this.newCharacterName&&this.newCharacterName!==this.selectedCharacter,e=this.newCharacterColor&&this.newCharacterColor!==this.selectedGroup.color;return t||e||this.convertToNarrator},progressPercentage(){return this.progressTotal===0?0:Math.round(this.progressCurrent/this.progressTotal*100)}},methods:{getListAvatarStyle(t){const e=(t==null?void 0:t.color)||"var(--border-color)",r={borderColor:e};return t!=null&&t.avatarUrl||(r.backgroundColor=e),r},getPreviewAvatarStyle(t,e){const r=e||"var(--border-color)",h={borderColor:r};return t!=null&&t.avatarUrl||(h.backgroundColor=r),h},selectCharacter(t){this.selectedCharacter=t,this.newCharacterName=t,this.newCharacterColor=this.selectedGroup.color,this.convertToNarrator=!1},resetForm(){this.selectedGroup&&(this.newCharacterName=this.selectedCharacter,this.newCharacterColor=this.selectedGroup.color,this.convertToNarrator=!1)},cancelNarratorConfirm(){this.showNarratorConfirm=!1},confirmNarratorAndApply(){this.narratorConfirmAcknowledged=!0,this.showNarratorConfirm=!1,this.applyChanges()},async applyChanges(){if(!this.hasChanges||this.isApplying)return;if(this.convertToNarrator&&!this.narratorConfirmAcknowledged){this.showNarratorConfirm=!0;return}const t=this.selectedCharacter,e=this.newCharacterName||t,r=this.newCharacterColor;this.isApplying=!0,this.progressCurrent=0,this.progressTotal=this.selectedGroup.count;try{this.$emit("bulk-update",{oldName:t,newName:e,newColor:r,convertToNarrator:this.convertToNarrator,onProgress:(h,l)=>{this.progressCurrent=h,this.progressTotal=l},onComplete:async h=>{await new Promise(l=>setTimeout(l,300)),this.isApplying=!1,this.progressCurrent=0,this.progressTotal=0,await new Promise(l=>setTimeout(l,150)),alert(h.message),this.selectedCharacter=null,this.newCharacterName="",this.newCharacterColor="",this.convertToNarrator=!1}})}catch(h){console.error("ì¼ê´„ ë³€ê²½ ì‹¤íŒ¨:",h),this.isApplying=!1,this.progressCurrent=0,this.progressTotal=0,await new Promise(l=>setTimeout(l,150)),alert("ìºë¦­í„° ì¼ê´„ ë³€ê²½ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}}}},il={class:"character-bulk-editor"},rl={key:0,class:"loading-overlay"},nl={class:"loading-content"},dl={class:"progress-section"},ul={class:"progress-bar"},cl={class:"progress-text"},pl={class:"editor-header"},hl={class:"editor-body"},ml={class:"info-message"},fl={class:"character-list"},gl={class:"list-header"},vl={class:"list-body"},bl=["onClick"],yl=["src","alt"],Cl={key:1},Vl={class:"character-info"},Sl={class:"character-name"},kl={class:"character-count"},xl={key:0,class:"edit-form"},wl={class:"form-header"},Ul={class:"affected-count"},Bl={class:"field-group"},Dl=["placeholder"],Il={class:"field-group"},Tl={class:"color-picker-wrapper"},_l=["placeholder"],zl={class:"field-group"},jl={class:"checkbox-row"},Pl={class:"option-help"},El={class:"preview-section"},Rl={class:"preview-comparison"},Nl={class:"preview-item before"},Ol={class:"preview-box"},Fl=["src","alt"],Al={key:1},Ll={class:"preview-arrow"},Ml={class:"preview-item after"},Hl={class:"preview-box"},Jl=["src","alt"],Gl={key:1},Wl={class:"actions"},Xl=["disabled"],ql=["disabled"],Kl={key:1,class:"no-selection"},Yl={class:"confirm-content"},Ql={class:"confirm-title"},Zl={class:"confirm-buttons"};function $l(t,e,r,h,l,a){const i=x("EmojiToIcon");return c(),p("div",il,[l.isApplying?(c(),p("div",rl,[s("div",nl,[e[9]||(e[9]=s("div",{class:"spinner"},null,-1)),e[10]||(e[10]=s("p",{class:"loading-text"},"ìºë¦­í„° ì •ë³´ë¥¼ ì¼ê´„ ë³€ê²½í•˜ëŠ” ì¤‘...",-1)),s("div",dl,[s("div",ul,[s("div",{class:"progress-fill",style:I({width:a.progressPercentage+"%"})},null,4)]),s("p",cl,y(l.progressCurrent)+" / "+y(l.progressTotal)+" ìŠ¤í… ("+y(a.progressPercentage)+"%)",1)]),e[11]||(e[11]=s("p",{class:"loading-subtext"},"ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”",-1))])])):g("",!0),s("div",pl,[s("h3",null,[d(i,{emoji:"ğŸ‘¥",size:20}),e[12]||(e[12]=m(" ìºë¦­í„° ì¼ê´„ í¸ì§‘ ",-1))])]),s("div",hl,[s("div",ml,[d(i,{emoji:"ğŸ’¡",size:18}),e[13]||(e[13]=s("p",null,"ê°™ì€ ì´ë¦„ì˜ ìºë¦­í„°ë¥¼ ëª¨ë‘ ì„ íƒí•˜ì—¬ ì´ë¦„ê³¼ ìƒ‰ìƒì„ ì¼ê´„ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",-1))]),s("div",fl,[s("div",gl,[s("h4",null,"ìºë¦­í„° ëª©ë¡ ("+y(a.characterGroups.length)+"ëª…)",1)]),s("div",vl,[(c(!0),p(k,null,U(a.characterGroups,o=>(c(),p("div",{key:o.name,class:w(["character-item",{selected:l.selectedCharacter===o.name}]),onClick:v=>a.selectCharacter(o.name)},[s("div",{class:"character-avatar",style:I(a.getListAvatarStyle(o))},[o.avatarUrl?(c(),p("img",{key:0,src:o.avatarUrl,alt:`${o.name||"ìºë¦­í„°"} ì•„ë°”íƒ€`,loading:"lazy",referrerpolicy:"no-referrer"},null,8,yl)):(c(),p("span",Cl,y((o.name||"?").charAt(0)),1))],4),s("div",Vl,[s("div",Sl,y(o.name||"(ì´ë¦„ ì—†ìŒ)"),1),s("div",kl,y(o.count)+"ê°œ ìŠ¤í…",1)])],10,bl))),128))])]),l.selectedCharacter?(c(),p("div",xl,[s("div",wl,[s("h4",null,[d(i,{emoji:"âœï¸",size:16}),m(' "'+y(l.selectedCharacter)+'" í¸ì§‘ ',1)]),s("span",Ul,y(a.selectedGroup.count)+"ê°œ ìŠ¤í…ì— ì ìš©ë©ë‹ˆë‹¤",1)]),s("div",Bl,[e[14]||(e[14]=s("label",{class:"field-label"},"ìƒˆ ìºë¦­í„° ì´ë¦„",-1)),f(s("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>l.newCharacterName=o),type:"text",class:"field-input",placeholder:l.selectedCharacter},null,8,Dl),[[b,l.newCharacterName]])]),s("div",Il,[e[15]||(e[15]=s("label",{class:"field-label"},"ìƒˆ ìºë¦­í„° ìƒ‰ìƒ",-1)),s("div",Tl,[f(s("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>l.newCharacterColor=o),type:"color",class:"color-picker"},null,512),[[b,l.newCharacterColor]]),f(s("input",{"onUpdate:modelValue":e[2]||(e[2]=o=>l.newCharacterColor=o),type:"text",class:"color-input",placeholder:a.selectedGroup.color},null,8,_l),[[b,l.newCharacterColor]])])]),s("div",zl,[e[18]||(e[18]=s("label",{class:"field-label"},"ë‚˜ë ˆì´í„° ë³€í™˜",-1)),s("label",jl,[f(s("input",{"onUpdate:modelValue":e[3]||(e[3]=o=>l.convertToNarrator=o),type:"checkbox",class:"checkbox-input"},null,512),[[P,l.convertToNarrator]]),e[16]||(e[16]=s("span",{class:"checkbox-text"},[m(" ì„ íƒ ìºë¦­í„°ì˜ ìŠ¤í…ì„ "),s("strong",null,"ë‚˜ë ˆì´í„°"),m(" íƒ€ì…ìœ¼ë¡œ ë³€í™˜ ")],-1))]),s("p",Pl,[d(i,{emoji:"âš ï¸",size:14}),e[17]||(e[17]=m(" ë³€í™˜ í›„ì—ëŠ” ëŒ€ì‚¬ ë°•ìŠ¤ê°€ ë‚˜ë ˆì´í„° ìŠ¤íƒ€ì¼ë¡œ í‘œì‹œë©ë‹ˆë‹¤. ",-1))])]),s("div",El,[e[21]||(e[21]=s("h5",null,"ë³€ê²½ ì „/í›„ ë¯¸ë¦¬ë³´ê¸°",-1)),s("div",Rl,[s("div",Nl,[e[19]||(e[19]=s("span",{class:"preview-label"},"ë³€ê²½ ì „",-1)),s("div",Ol,[s("div",{class:"preview-avatar",style:I(a.getPreviewAvatarStyle(a.selectedGroup,a.selectedGroup.color))},[a.selectedGroup.avatarUrl?(c(),p("img",{key:0,src:a.selectedGroup.avatarUrl,alt:`${l.selectedCharacter} ì•„ë°”íƒ€`,loading:"lazy",referrerpolicy:"no-referrer"},null,8,Fl)):(c(),p("span",Al,y(l.selectedCharacter.charAt(0)),1))],4),s("span",{class:"preview-name",style:I({color:a.selectedGroup.color})},y(l.selectedCharacter),5)])]),s("div",Ll,[d(i,{emoji:"â¡ï¸",size:24})]),s("div",Ml,[e[20]||(e[20]=s("span",{class:"preview-label"},"ë³€ê²½ í›„",-1)),s("div",Hl,[s("div",{class:"preview-avatar",style:I(a.getPreviewAvatarStyle(a.selectedGroup,l.newCharacterColor))},[a.selectedGroup.avatarUrl?(c(),p("img",{key:0,src:a.selectedGroup.avatarUrl,alt:`${l.newCharacterName||l.selectedCharacter} ì•„ë°”íƒ€`,loading:"lazy",referrerpolicy:"no-referrer"},null,8,Jl)):(c(),p("span",Gl,y((l.newCharacterName||l.selectedCharacter).charAt(0)),1))],4),s("span",{class:"preview-name",style:I({color:l.newCharacterColor})},y(l.newCharacterName||l.selectedCharacter),5)])])])]),s("div",Wl,[s("button",{onClick:e[4]||(e[4]=(...o)=>a.resetForm&&a.resetForm(...o)),class:"reset-button",disabled:l.isApplying},[d(i,{emoji:"ğŸ”„",size:16}),e[22]||(e[22]=m(" ì´ˆê¸°í™” ",-1))],8,Xl),s("button",{onClick:e[5]||(e[5]=(...o)=>a.applyChanges&&a.applyChanges(...o)),class:"apply-button",disabled:!a.hasChanges||l.isApplying},[l.isApplying?(c(),p(k,{key:0},[e[23]||(e[23]=s("div",{class:"button-spinner"},null,-1)),e[24]||(e[24]=m(" ì²˜ë¦¬ ì¤‘... ",-1))],64)):(c(),p(k,{key:1},[d(i,{emoji:"âœ…",size:16}),e[25]||(e[25]=m(" ì¼ê´„ ì ìš© ",-1))],64))],8,ql)])])):(c(),p("div",Kl,[d(i,{emoji:"ğŸ‘†",size:48}),e[26]||(e[26]=s("p",null,"ì™¼ìª½ì—ì„œ ìºë¦­í„°ë¥¼ ì„ íƒí•˜ì„¸ìš”",-1))])),l.showNarratorConfirm?(c(),p("div",{key:2,class:"confirm-modal",onClick:e[8]||(e[8]=E(()=>{},["stop"]))},[s("div",Yl,[s("h3",Ql,[d(i,{emoji:"âš ï¸",size:18}),e[27]||(e[27]=m(" ë‚˜ë ˆì´í„° ë³€í™˜ í™•ì¸ ",-1))]),e[28]||(e[28]=s("p",{class:"confirm-text"},[m(" ì„ íƒí•œ ìºë¦­í„°ì˜ ëª¨ë“  ìŠ¤í… íƒ€ì…ì´ "),s("strong",null,"ë‚˜ë ˆì´í„°"),m("ë¡œ ë³€ê²½ë©ë‹ˆë‹¤. ")],-1)),s("div",Zl,[s("button",{class:"action-button secondary",onClick:e[6]||(e[6]=(...o)=>a.cancelNarratorConfirm&&a.cancelNarratorConfirm(...o))}," ì·¨ì†Œ "),s("button",{class:"action-button primary",onClick:e[7]||(e[7]=(...o)=>a.confirmNarratorAndApply&&a.confirmNarratorAndApply(...o))}," ë³€í™˜ ì ìš© ")])])])):g("",!0)])])}const eo=D(al,[["render",$l],["__scopeId","data-v-5f957928"]]),to={name:"ImageBulkEditor",props:{vnData:{type:Object,required:!0}},data(){return{selectedImageUrl:null,newImageUrl:"",isApplying:!1,progressCurrent:0,progressTotal:0,activeFilter:"all",imageTypes:[{value:"all",label:"ì „ì²´",emoji:"ğŸŒ"},{value:"avatar",label:"ì•„ë°”íƒ€",emoji:"ğŸ‘¤"},{value:"background",label:"ë°°ê²½",emoji:"ğŸ¨"},{value:"handout",label:"í•¸ë“œì•„ì›ƒ",emoji:"ğŸ“„"},{value:"illustration",label:"ì¼ëŸ¬ìŠ¤íŠ¸",emoji:"ğŸ–¼ï¸"}],isLoadingFile:!1}},computed:{imageGroups(){const t={};return this.vnData.scenes&&this.vnData.scenes.forEach((e,r)=>{var h;(h=e.steps)==null||h.forEach((l,a)=>{var v,n;const i=(v=l.character)==null?void 0:v.avatarUrl;if(i){t[i]||(t[i]={url:i,count:0,types:new Set,locations:{avatar:[],background:[],handout:[],illustration:[]}}),t[i].count++,t[i].types.add("avatar");const u=l.character.name;t[i].locations.avatar.includes(u)||t[i].locations.avatar.push(u)}const o=(n=l.effects)==null?void 0:n.background;o&&(t[o]||(t[o]={url:o,count:0,types:new Set,locations:{avatar:[],background:[],handout:[],illustration:[]}}),t[o].count++,t[o].types.add("background"),t[o].locations.background.push(`ì”¬${r+1} ìŠ¤í…${a+1}`)),l.illustrations&&Array.isArray(l.illustrations)&&l.illustrations.forEach((u,V)=>{const S=u.url;S&&(t[S]||(t[S]={url:S,count:0,types:new Set,locations:{avatar:[],background:[],handout:[],illustration:[]}}),t[S].count++,t[S].types.add("illustration"),t[S].locations.illustration.push(`ì”¬${r+1} ìŠ¤í…${a+1}-${V+1}`))})})}),this.vnData.handouts&&this.vnData.handouts.forEach(e=>{const r=e.imageUrl;r&&(t[r]||(t[r]={url:r,count:0,types:new Set,locations:{avatar:[],background:[],handout:[],illustration:[]}}),t[r].count++,t[r].types.add("handout"),t[r].locations.handout.push(e.title||e.id))}),Object.values(t).map(e=>({...e,types:Array.from(e.types)})).sort((e,r)=>r.count-e.count)},filteredImageGroups(){return this.activeFilter==="all"?this.imageGroups:this.imageGroups.filter(t=>t.types.includes(this.activeFilter))},selectedGroup(){return this.selectedImageUrl?this.imageGroups.find(t=>t.url===this.selectedImageUrl):null},hasChanges(){return this.selectedImageUrl?this.newImageUrl&&this.newImageUrl!==this.selectedImageUrl:!1},progressPercentage(){return this.progressTotal===0?0:Math.round(this.progressCurrent/this.progressTotal*100)}},methods:{selectImage(t){this.selectedImageUrl=t,this.newImageUrl=t},resetForm(){this.selectedGroup&&(this.newImageUrl=this.selectedImageUrl)},async handleImageFileSelect(t){const e=t.target.files[0];if(e){if(e.size>2*1024*1024){alert("ì´ë¯¸ì§€ íŒŒì¼ í¬ê¸°ëŠ” 2MB ì´í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤."),t.target.value="";return}this.isLoadingFile=!0;try{const r=await this.fileToBase64(e);this.newImageUrl=r,console.log("[ImageBulkEditor] ì´ë¯¸ì§€ íŒŒì¼ ë¡œë“œ ì™„ë£Œ:",{fileName:e.name,fileSize:e.size,base64Length:r.length})}catch(r){console.error("[ImageBulkEditor] íŒŒì¼ ë¡œë“œ ì‹¤íŒ¨:",r),alert("íŒŒì¼ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}finally{this.isLoadingFile=!1,t.target.value=""}}},fileToBase64(t){return new Promise((e,r)=>{const h=new FileReader;h.onload=()=>e(h.result),h.onerror=r,h.readAsDataURL(t)})},clearNewImage(){this.newImageUrl=this.selectedImageUrl},truncateUrl(t,e=50){return t?t.length<=e?t:t.substring(0,e-3)+"...":""},handleImageError(t){t.target.style.display="none",t.target.parentElement.classList.add("error")},async applyChanges(){if(!this.hasChanges||this.isApplying)return;const t=this.selectedImageUrl,e=this.newImageUrl;this.isApplying=!0,this.progressCurrent=0,this.progressTotal=this.selectedGroup.count;try{this.$emit("bulk-update",{oldUrl:t,newUrl:e,onProgress:(r,h)=>{this.progressCurrent=r,this.progressTotal=h},onComplete:async r=>{await new Promise(h=>setTimeout(h,300)),this.isApplying=!1,this.progressCurrent=0,this.progressTotal=0,await new Promise(h=>setTimeout(h,150)),alert(r.message),this.selectedImageUrl=null,this.newImageUrl=""}})}catch(r){console.error("ì¼ê´„ ë³€ê²½ ì‹¤íŒ¨:",r),this.isApplying=!1,this.progressCurrent=0,this.progressTotal=0,await new Promise(h=>setTimeout(h,150)),alert("ì´ë¯¸ì§€ URL ì¼ê´„ ë³€ê²½ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")}}}},so={class:"image-bulk-editor"},lo={key:0,class:"loading-overlay"},oo={class:"loading-content"},ao={class:"progress-section"},io={class:"progress-bar"},ro={class:"progress-text"},no={class:"editor-header"},uo={class:"editor-body"},co={class:"info-message"},po={class:"image-list"},ho={class:"list-header"},mo={class:"filter-buttons"},fo=["onClick"],go={class:"list-body"},vo=["onClick"],bo={class:"image-preview"},yo=["src","alt"],Co={class:"image-info"},Vo=["title"],So={class:"image-meta"},ko={class:"usage-count"},xo={class:"usage-types"},wo={key:0,class:"edit-form"},Uo={class:"form-header"},Bo={class:"affected-count"},Do={class:"field-group"},Io={class:"current-url"},To={class:"field-group"},_o={class:"file-input-group"},zo=["disabled"],jo=["disabled"],Po={class:"hint-text"},Eo={class:"preview-section"},Ro={class:"preview-comparison"},No={class:"preview-item before"},Oo={class:"preview-box"},Fo=["src"],Ao={class:"preview-arrow"},Lo={class:"preview-item after"},Mo={class:"preview-box"},Ho=["src"],Jo={key:1,class:"preview-placeholder"},Go={class:"usage-details"},Wo={class:"usage-list"},Xo={key:0,class:"usage-type"},qo={key:1,class:"usage-type"},Ko={key:2,class:"usage-type"},Yo={key:3,class:"usage-type"},Qo={class:"actions"},Zo=["disabled"],$o=["disabled"],ea={key:1,class:"no-selection"};function ta(t,e,r,h,l,a){const i=x("EmojiToIcon");return c(),p("div",so,[l.isApplying?(c(),p("div",lo,[s("div",oo,[e[9]||(e[9]=s("div",{class:"spinner"},null,-1)),e[10]||(e[10]=s("p",{class:"loading-text"},"ì´ë¯¸ì§€ URLì„ ì¼ê´„ ë³€ê²½í•˜ëŠ” ì¤‘...",-1)),s("div",ao,[s("div",io,[s("div",{class:"progress-fill",style:I({width:a.progressPercentage+"%"})},null,4)]),s("p",ro,y(l.progressCurrent)+" / "+y(l.progressTotal)+" í•­ëª© ("+y(a.progressPercentage)+"%)",1)]),e[11]||(e[11]=s("p",{class:"loading-subtext"},"ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”",-1))])])):g("",!0),s("div",no,[s("h3",null,[d(i,{emoji:"ğŸ–¼ï¸",size:20}),e[12]||(e[12]=m(" ì´ë¯¸ì§€ URL ì¼ê´„ í¸ì§‘ ",-1))])]),s("div",uo,[s("div",co,[d(i,{emoji:"ğŸ’¡",size:18}),e[13]||(e[13]=s("p",null,"ë™ì¼í•œ ì´ë¯¸ì§€ URLì„ ëª¨ë‘ ì„ íƒí•˜ì—¬ í•œ ë²ˆì— ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. (ì•„ë°”íƒ€, ë°°ê²½, í•¸ë“œì•„ì›ƒ ë“±)",-1))]),s("div",po,[s("div",ho,[s("h4",null,"ì´ë¯¸ì§€ URL ëª©ë¡ ("+y(a.imageGroups.length)+"ê°œ)",1),s("div",mo,[(c(!0),p(k,null,U(l.imageTypes,o=>(c(),p("button",{key:o.value,class:w(["filter-button",{active:l.activeFilter===o.value}]),onClick:v=>l.activeFilter=o.value},[d(i,{emoji:o.emoji,size:14},null,8,["emoji"]),m(" "+y(o.label),1)],10,fo))),128))])]),s("div",go,[(c(!0),p(k,null,U(a.filteredImageGroups,o=>(c(),p("div",{key:o.url,class:w(["image-item",{selected:l.selectedImageUrl===o.url}]),onClick:v=>a.selectImage(o.url)},[s("div",bo,[s("img",{src:o.url,alt:o.url,onError:e[0]||(e[0]=(...v)=>a.handleImageError&&a.handleImageError(...v))},null,40,yo)]),s("div",Co,[s("div",{class:"image-url",title:o.url},y(a.truncateUrl(o.url)),9,Vo),s("div",So,[s("span",ko,y(o.count)+"íšŒ ì‚¬ìš©",1),s("span",xo,[o.types.includes("avatar")?(c(),_(i,{key:0,emoji:"ğŸ‘¤",size:12,title:"ì•„ë°”íƒ€"})):g("",!0),o.types.includes("background")?(c(),_(i,{key:1,emoji:"ğŸ¨",size:12,title:"ë°°ê²½"})):g("",!0),o.types.includes("handout")?(c(),_(i,{key:2,emoji:"ğŸ“„",size:12,title:"í•¸ë“œì•„ì›ƒ"})):g("",!0),o.types.includes("illustration")?(c(),_(i,{key:3,emoji:"ğŸ–¼ï¸",size:12,title:"ì¼ëŸ¬ìŠ¤íŠ¸"})):g("",!0)])])])],10,vo))),128))])]),l.selectedImageUrl?(c(),p("div",wo,[s("div",Uo,[s("h4",null,[d(i,{emoji:"âœï¸",size:16}),e[14]||(e[14]=m(" URL ë³€ê²½ ",-1))]),s("span",Bo,y(a.selectedGroup.count)+"ê°œ í•­ëª©ì— ì ìš©ë©ë‹ˆë‹¤",1)]),s("div",Do,[e[15]||(e[15]=s("label",{class:"field-label"},"í˜„ì¬ ì´ë¯¸ì§€ URL",-1)),s("div",Io,y(l.selectedImageUrl),1)]),s("div",To,[e[18]||(e[18]=s("label",{class:"field-label"},"ìƒˆ ì´ë¯¸ì§€ URL",-1)),s("div",_o,[f(s("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>l.newImageUrl=o),type:"text",class:"field-input",placeholder:"ìƒˆ ì´ë¯¸ì§€ URL ì…ë ¥ ë˜ëŠ” íŒŒì¼ ì„ íƒ"},null,512),[[b,l.newImageUrl]]),s("input",{ref:"imageFileInput",type:"file",accept:"image/*",onChange:e[2]||(e[2]=(...o)=>a.handleImageFileSelect&&a.handleImageFileSelect(...o)),style:{display:"none"}},null,544),s("button",{onClick:e[3]||(e[3]=o=>t.$refs.imageFileInput.click()),class:"file-select-button",disabled:l.isApplying},[d(i,{emoji:"ğŸ“",size:14}),e[16]||(e[16]=m(" íŒŒì¼ ",-1))],8,zo),l.newImageUrl?(c(),p("button",{key:0,onClick:e[4]||(e[4]=(...o)=>a.clearNewImage&&a.clearNewImage(...o)),class:"clear-button",disabled:l.isApplying},[d(i,{emoji:"âœ–ï¸",size:14})],8,jo)):g("",!0)]),s("p",Po,[d(i,{emoji:"ğŸ’¡",size:12}),e[17]||(e[17]=m(" ë¡œì»¬ íŒŒì¼ì€ base64ë¡œ ì¸ì½”ë”© (2MB ì´í•˜) ",-1))])]),s("div",Eo,[e[22]||(e[22]=s("h5",null,"ë³€ê²½ ì „/í›„ ë¯¸ë¦¬ë³´ê¸°",-1)),s("div",Ro,[s("div",No,[e[19]||(e[19]=s("span",{class:"preview-label"},"ë³€ê²½ ì „",-1)),s("div",Oo,[s("img",{src:l.selectedImageUrl,alt:"ë³€ê²½ ì „",onError:e[5]||(e[5]=(...o)=>a.handleImageError&&a.handleImageError(...o))},null,40,Fo)])]),s("div",Ao,[d(i,{emoji:"â¡ï¸",size:24})]),s("div",Lo,[e[21]||(e[21]=s("span",{class:"preview-label"},"ë³€ê²½ í›„",-1)),s("div",Mo,[l.newImageUrl?(c(),p("img",{key:0,src:l.newImageUrl,alt:"ë³€ê²½ í›„",onError:e[6]||(e[6]=(...o)=>a.handleImageError&&a.handleImageError(...o))},null,40,Ho)):(c(),p("div",Jo,[d(i,{emoji:"ğŸ–¼ï¸",size:32}),e[20]||(e[20]=s("span",null,"URLì„ ì…ë ¥í•˜ì„¸ìš”",-1))]))])])])]),s("div",Go,[e[23]||(e[23]=s("h5",null,"ì‚¬ìš© ìœ„ì¹˜ ìƒì„¸",-1)),s("div",Wo,[a.selectedGroup.types.includes("avatar")?(c(),p("div",Xo,[d(i,{emoji:"ğŸ‘¤",size:16}),s("span",null,"ì•„ë°”íƒ€ ("+y(a.selectedGroup.locations.avatar.length)+"ê°œ ìºë¦­í„°)",1)])):g("",!0),a.selectedGroup.types.includes("background")?(c(),p("div",qo,[d(i,{emoji:"ğŸ¨",size:16}),s("span",null,"ë°°ê²½ ("+y(a.selectedGroup.locations.background.length)+"ê°œ ìŠ¤í…)",1)])):g("",!0),a.selectedGroup.types.includes("handout")?(c(),p("div",Ko,[d(i,{emoji:"ğŸ“„",size:16}),s("span",null,"í•¸ë“œì•„ì›ƒ ("+y(a.selectedGroup.locations.handout.length)+"ê°œ)",1)])):g("",!0),a.selectedGroup.types.includes("illustration")?(c(),p("div",Yo,[d(i,{emoji:"ğŸ–¼ï¸",size:16}),s("span",null,"ì¼ëŸ¬ìŠ¤íŠ¸ ("+y(a.selectedGroup.locations.illustration.length)+"ê°œ)",1)])):g("",!0)])]),s("div",Qo,[s("button",{onClick:e[7]||(e[7]=(...o)=>a.resetForm&&a.resetForm(...o)),class:"reset-button",disabled:l.isApplying},[d(i,{emoji:"ğŸ”„",size:16}),e[24]||(e[24]=m(" ì´ˆê¸°í™” ",-1))],8,Zo),s("button",{onClick:e[8]||(e[8]=(...o)=>a.applyChanges&&a.applyChanges(...o)),class:"apply-button",disabled:!a.hasChanges||l.isApplying},[l.isApplying?(c(),p(k,{key:0},[e[25]||(e[25]=s("div",{class:"button-spinner"},null,-1)),e[26]||(e[26]=m(" ì²˜ë¦¬ ì¤‘... ",-1))],64)):(c(),p(k,{key:1},[d(i,{emoji:"âœ…",size:16}),e[27]||(e[27]=m(" ì¼ê´„ ì ìš© ",-1))],64))],8,$o)])])):(c(),p("div",ea,[d(i,{emoji:"ğŸ‘†",size:48}),e[28]||(e[28]=s("p",null,"ì™¼ìª½ì—ì„œ ì´ë¯¸ì§€ URLì„ ì„ íƒí•˜ì„¸ìš”",-1))]))])])}const sa=D(to,[["render",ta],["__scopeId","data-v-6897d383"]]),la={name:"ColorPicker",props:{modelValue:{type:String,default:"#ffffff"},supportsAlpha:{type:Boolean,default:!0},placeholder:{type:String,default:"#ffffff ë˜ëŠ” rgba(255,255,255,0.8)"}},data(){return{hexValue:"#ffffff",opacityValue:1,tempTextValue:""}},computed:{displayValue(){return this.tempTextValue||this.modelValue}},watch:{modelValue:{immediate:!0,handler(t){t&&!this.tempTextValue&&this.parseColor(t)}}},methods:{parseColor(t){if(!t)return;const e=t.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*([\d.]+))?\)/);if(e){const r=parseInt(e[1]),h=parseInt(e[2]),l=parseInt(e[3]),a=e[4]?parseFloat(e[4]):1;this.hexValue=this.rgbToHex(r,h,l),this.opacityValue=a;return}if(t.startsWith("#")){this.hexValue=t,this.opacityValue=1;return}this.hexValue=t,this.opacityValue=1},rgbToHex(t,e,r){return"#"+[t,e,r].map(h=>{const l=h.toString(16);return l.length===1?"0"+l:l}).join("")},hexToRgb(t){const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null},buildColorString(){if(!this.supportsAlpha||this.opacityValue===1)return this.hexValue;const t=this.hexToRgb(this.hexValue);return t?`rgba(${t.r}, ${t.g}, ${t.b}, ${this.opacityValue})`:this.hexValue},handleColorChange(t){this.hexValue=t.target.value,this.tempTextValue="",this.emitValue()},handleOpacityChange(t){this.opacityValue=parseFloat(t.target.value),this.tempTextValue="",this.emitValue()},handleTextChange(t){this.tempTextValue=t.target.value},validateAndUpdate(){const t=this.tempTextValue;if(!t){this.tempTextValue="";return}this.parseColor(t),this.tempTextValue="",this.emitValue()},emitValue(){const t=this.buildColorString();this.$emit("update:modelValue",t)}}},oa={class:"color-picker"},aa={class:"color-inputs"},ia=["value"],ra=["value","placeholder"],na={key:0,class:"opacity-slider"},da=["value"],ua={class:"opacity-value"};function ca(t,e,r,h,l,a){return c(),p("div",oa,[s("div",aa,[s("input",{type:"color",value:l.hexValue,onInput:e[0]||(e[0]=(...i)=>a.handleColorChange&&a.handleColorChange(...i)),class:"color-swatch"},null,40,ia),s("input",{type:"text",value:a.displayValue,onInput:e[1]||(e[1]=(...i)=>a.handleTextChange&&a.handleTextChange(...i)),onBlur:e[2]||(e[2]=(...i)=>a.validateAndUpdate&&a.validateAndUpdate(...i)),class:"color-text",placeholder:r.placeholder},null,40,ra)]),r.supportsAlpha?(c(),p("div",na,[e[4]||(e[4]=s("label",{class:"opacity-label"},"íˆ¬ëª…ë„",-1)),s("input",{type:"range",value:l.opacityValue,onInput:e[3]||(e[3]=(...i)=>a.handleOpacityChange&&a.handleOpacityChange(...i)),min:"0",max:"1",step:"0.01",class:"opacity-range"},null,40,da),s("span",ua,y(Math.round(l.opacityValue*100))+"%",1)])):g("",!0)])}const pa=D(la,[["render",ca],["__scopeId","data-v-1748c9a3"]]),ha={name:"UnitInput",props:{modelValue:{type:String,default:"0px"},units:{type:Array,default:()=>["px","rem","em","%","vh","vw"]},min:{type:Number,default:0},max:{type:Number,default:null},step:{type:Number,default:1},placeholder:{type:String,default:"0"}},data(){return{numericValue:0,unitValue:"px"}},computed:{availableUnits(){return this.units}},watch:{modelValue:{immediate:!0,handler(t){this.parseValue(t)}}},methods:{parseValue(t){if(!t||t===""){this.numericValue=0,this.unitValue=this.units[0]||"px";return}const e=String(t).match(/^([-+]?[\d.]+)([a-z%]+)?$/i);e?(this.numericValue=parseFloat(e[1])||0,this.unitValue=e[2]||this.units[0]||"px"):(this.numericValue=0,this.unitValue=this.units[0]||"px")},handleNumberChange(t){this.numericValue=parseFloat(t.target.value)||0,this.emitValue()},handleUnitChange(t){this.unitValue=t.target.value,this.emitValue()},emitValue(){const t=`${this.numericValue}${this.unitValue}`;this.$emit("update:modelValue",t)}}},ma={class:"unit-input"},fa=["value","min","max","step","placeholder"],ga=["value"],va=["value"];function ba(t,e,r,h,l,a){return c(),p("div",ma,[s("input",{type:"number",value:l.numericValue,onInput:e[0]||(e[0]=(...i)=>a.handleNumberChange&&a.handleNumberChange(...i)),min:r.min,max:r.max,step:r.step,class:"unit-number",placeholder:r.placeholder},null,40,fa),s("select",{value:l.unitValue,onChange:e[1]||(e[1]=(...i)=>a.handleUnitChange&&a.handleUnitChange(...i)),class:"unit-select"},[(c(!0),p(k,null,U(a.availableUnits,i=>(c(),p("option",{key:i,value:i},y(i),9,va))),128))],40,ga)])}const ya=D(ha,[["render",ba],["__scopeId","data-v-abe357bb"]]),Ca={name:"CustomCSSEditor",components:{ColorPicker:pa,UnitInput:ya,EmbedPlayerView:N},props:{initialCSS:{type:Object,default:()=>({})}},data(){return{currentSection:"dialog",sections:[{id:"dialog",name:"ëŒ€ì‚¬ ë°•ìŠ¤",icon:"ğŸ’¬"},{id:"character",name:"ìºë¦­í„°",icon:"ğŸ‘¤"},{id:"controls",name:"ì»¨íŠ¸ë¡¤",icon:"ğŸ®"},{id:"overlay",name:"ì˜¤ë²„ë ˆì´",icon:"ğŸ“±"},{id:"global",name:"ì „ì—­",icon:"ğŸŒ"},{id:"code",name:"CSS ì½”ë“œ",icon:"ğŸ“"}],cssVars:this.getDefaultCSSVars(),cssCodeText:"",userCustomCSS:""}},watch:{currentSection(){this.$nextTick(()=>{const t=this.$refs.embedPlayerPreview;t&&t.showOverlaysIfPresent&&t.showOverlaysIfPresent()})}},computed:{mockVNData(){const t={title:"CSS Preview",theme:{primaryColor:"#5b8def",backgroundColor:"#1a1a2e",textColor:"#ffffff"},characters:{Alice:{name:"Alice",color:"#9c27b0"},Bob:{name:"Bob",color:"#2196f3"}},handouts:[],scenes:[]};return this.currentSection==="dialog"?t.scenes=[{id:"scene_0",name:"Dialog Preview",description:null,steps:[{id:"step_0_0",type:"dialogue",character:{name:"Alice",color:"#9c27b0",avatarUrl:null},text:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.",rawText:"Lorem ipsum dolor sit amet, consectetur adipiscing elit.",diceRolls:[],hasDice:!1,ougis:[],hasOugi:!1,shinobigamis:[],hasShinobigami:!1,statusChanges:[],hasStatusChange:!1,dxCombos:[],hasDXCombo:!1,effects:{sfx:null,bgm:null,background:null,backgroundOpacity:.3}}]}]:this.currentSection==="character"?t.scenes=[{id:"scene_0",name:"Character Preview",description:null,steps:[{id:"step_0_0",type:"dialogue",character:{name:"Alice",color:"#9c27b0",avatarUrl:"https://placehold.co/400"},text:"Character display preview text.",rawText:"Character display preview text.",diceRolls:[],hasDice:!1,ougis:[],hasOugi:!1,shinobigamis:[],hasShinobigami:!1,statusChanges:[],hasStatusChange:!1,dxCombos:[],hasDXCombo:!1,effects:{sfx:null,bgm:null,background:null,backgroundOpacity:.3}}]}]:this.currentSection==="controls"?t.scenes=[{id:"scene_0",name:"Sample Scene",description:null,steps:Array.from({length:10},(e,r)=>({id:`step_0_${r}`,type:"dialogue",character:{name:"Alice",color:"#9c27b0",avatarUrl:null},text:`Step ${r+1} content for testing playback controls.`,rawText:`Step ${r+1} content`,diceRolls:[],hasDice:!1,ougis:[],hasOugi:!1,shinobigamis:[],hasShinobigami:!1,statusChanges:[],hasStatusChange:!1,dxCombos:[],hasDXCombo:!1,effects:{sfx:null,bgm:null,background:null,backgroundOpacity:.3}}))}]:this.currentSection==="overlay"?t.scenes=[{id:"scene_0",name:"Overlay Preview",description:null,steps:[{id:"step_0_0",type:"dialogue",character:{name:"Alice",color:"#9c27b0",avatarUrl:null},text:"* ë‹¤ì´ìŠ¤",rawText:"2d6+3",diceRolls:[{type:"normal",formula:"2d6+3",result:11,rolls:[4,4],modifier:3,detail:"2d6+3 â†’ [4,4]+3 â†’ 11"}],hasDice:!0,ougis:[],hasOugi:!1,shinobigamis:[],hasShinobigami:!1,statusChanges:[],hasStatusChange:!1,dxCombos:[],hasDXCombo:!1,effects:{sfx:null,bgm:null,background:null,backgroundOpacity:.3}}]}]:this.currentSection==="global"&&(t.scenes=[{id:"scene_0",name:"Global Preview",description:null,steps:[{id:"step_0_0",type:"dialogue",character:{name:"Alice",color:"#9c27b0",avatarUrl:null},text:"Sample text to show global styling with font and colors.",rawText:"Sample text to show global styling.",diceRolls:[],hasDice:!1,ougis:[],hasOugi:!1,shinobigamis:[],hasShinobigami:!1,statusChanges:[],hasStatusChange:!1,dxCombos:[],hasDXCombo:!1,effects:{sfx:null,bgm:null,background:null,backgroundOpacity:.3}}]}]),t}},methods:{getDefaultCSSVars(){return{dialogBackground:"rgba(0, 0, 0, 0.85)",dialogBorderColor:"rgba(255, 255, 255, 0.2)",dialogBorderWidth:"2px",dialogTextColor:"#ffffff",dialogNameFontSize:"18px",dialogTextFontSize:"16px",dialogPadding:"20px 24px",dialogBorderRadius:"8px",dialogMinHeight:"120px",dialogLineHeight:"1.8",characterMaxHeight:"350px",characterMaxWidth:"250px",characterInactiveOpacity:"0.95",characterBorderRadius:"8px",characterBorderWidth:"2px",characterTransition:"opacity 0.2s",controlsBackground:"rgba(255, 255, 255, 0.05)",controlsBorderColor:"rgba(255, 255, 255, 0.1)",controlsButtonColor:"#ffffff",controlsButtonHoverColor:"#ffffff",controlsButtonBg:"rgba(255, 255, 255, 0.1)",controlsButtonHoverBg:"rgba(255, 255, 255, 0.2)",controlsProgressColor:"#5b8def",controlsProgressBg:"rgba(255, 255, 255, 0.1)",controlsButtonSize:"48px",controlsPrimaryButtonSize:"64px",controlsBorderRadius:"6px",overlayBackground:"rgba(0, 0, 0, 0.7)",overlayBlur:"4px",overlayContentBackground:"rgba(30, 30, 40, 0.95)",overlayTextColor:"#ffffff",overlayBorderRadius:"8px",overlayPadding:"32px",overlayMaxWidth:"600px",globalBackground:"#1a1a2e",globalTextColor:"#ffffff",globalFontFamily:"var(--font-pretendard)",globalLineHeight:"1.5",globalBackgroundImage:"none",globalBackgroundSize:"cover"}},applyPreview(){this.updateCSSCodeText(),this.injectCustomStyleTag(),this.$refs.embedPlayerPreview&&this.$refs.embedPlayerPreview.$forceUpdate()},injectCustomStyleTag(){const t=document.getElementById("vnlog-custom-css");t&&t.remove();const e=this.generateCSSVariableRules(),r=document.createElement("style");r.id="vnlog-custom-css",r.textContent=e+`

`+this.userCustomCSS,document.head.appendChild(r),console.log("[CustomCSSEditor] CSS ìŠ¤íƒ€ì¼ íƒœê·¸ ì£¼ì… ì™„ë£Œ")},generateCSSVariableRules(){const t=["/* ========================================","   VNLog Custom CSS - Direct Override","   ======================================== */",""];return this.cssVars.dialogBackground&&(t.push("/* Dialog Box Container - Background */"),t.push(".dialog-box {"),t.push(`  background-color: ${this.cssVars.dialogBackground} !important;`),t.push("}"),t.push("")),this.cssVars.dialogBorderColor&&(t.push("/* Dialog Box Container - Border Color */"),t.push(".dialog-box {"),t.push(`  border-color: ${this.cssVars.dialogBorderColor} !important;`),t.push("}"),t.push("")),this.cssVars.dialogBorderWidth&&(t.push("/* Dialog Box Container - Border Width */"),t.push(".dialog-box {"),t.push(`  border-width: ${this.cssVars.dialogBorderWidth} !important;`),t.push("  border-style: solid !important;"),t.push("}"),t.push("")),this.cssVars.dialogBorderRadius&&(t.push("/* Dialog Box Container - Border Radius */"),t.push(".dialog-box {"),t.push(`  border-radius: ${this.cssVars.dialogBorderRadius} !important;`),t.push("}"),t.push("")),this.cssVars.dialogPadding&&(t.push("/* Dialog Box Container - Padding */"),t.push(".dialog-box {"),t.push(`  padding: ${this.cssVars.dialogPadding} !important;`),t.push("}"),t.push("")),this.cssVars.dialogMinHeight&&(t.push("/* Dialog Box Container - Min Height */"),t.push(".dialog-box {"),t.push(`  min-height: ${this.cssVars.dialogMinHeight} !important;`),t.push("}"),t.push("")),this.cssVars.dialogNameFontSize&&(t.push("/* Dialog Character Name - Font Size */"),t.push(".dialog-box .character-name {"),t.push(`  font-size: ${this.cssVars.dialogNameFontSize} !important;`),t.push("}"),t.push("")),this.cssVars.dialogTextColor&&(t.push("/* Dialog Text - Color */"),t.push(".dialog-box .dialog-text,"),t.push(".dialog-box .text-content {"),t.push(`  color: ${this.cssVars.dialogTextColor} !important;`),t.push("}"),t.push("")),this.cssVars.dialogTextFontSize&&(t.push("/* Dialog Text - Font Size */"),t.push(".dialog-box .dialog-text,"),t.push(".dialog-box .text-content {"),t.push(`  font-size: ${this.cssVars.dialogTextFontSize} !important;`),t.push("}"),t.push("")),this.cssVars.dialogLineHeight&&(t.push("/* Dialog Text - Line Height */"),t.push(".dialog-box .dialog-text,"),t.push(".dialog-box .text-content {"),t.push(`  line-height: ${this.cssVars.dialogLineHeight} !important;`),t.push("}"),t.push("")),this.cssVars.characterMaxWidth&&(t.push("/* Character Image - Max Width */"),t.push(".character-display .character-avatar img {"),t.push(`  max-width: ${this.cssVars.characterMaxWidth} !important;`),t.push("}"),t.push("")),this.cssVars.characterMaxHeight&&(t.push("/* Character Image - Max Height */"),t.push(".character-display .character-avatar img {"),t.push(`  max-height: ${this.cssVars.characterMaxHeight} !important;`),t.push("}"),t.push("")),this.cssVars.characterBorderRadius&&(t.push("/* Character Image - Border Radius */"),t.push(".character-display .character-avatar img {"),t.push(`  border-radius: ${this.cssVars.characterBorderRadius} !important;`),t.push("}"),t.push("")),this.cssVars.characterBorderWidth&&(t.push("/* Character Image - Border */"),t.push(".character-display .character-avatar img {"),t.push(`  border: ${this.cssVars.characterBorderWidth} solid rgba(255, 255, 255, 0.3) !important;`),t.push("}"),t.push("")),this.cssVars.characterTransition&&(t.push("/* Character Image - Transition */"),t.push(".character-display .character-avatar img {"),t.push(`  transition: ${this.cssVars.characterTransition} !important;`),t.push("}"),t.push("")),this.cssVars.characterInactiveOpacity&&(t.push("/* Character Inactive - Opacity */"),t.push(".character-display .character-wrapper:not(.is-speaking) .character-avatar img {"),t.push(`  opacity: ${this.cssVars.characterInactiveOpacity} !important;`),t.push("}"),t.push("")),this.cssVars.controlsBackground&&(t.push("/* Playback Controls Container - Background */"),t.push(".playback-controls {"),t.push(`  background: ${this.cssVars.controlsBackground} !important;`),t.push("}"),t.push("")),this.cssVars.controlsBorderColor&&(t.push("/* Playback Controls Container - Border Color */"),t.push(".playback-controls {"),t.push(`  border-color: ${this.cssVars.controlsBorderColor} !important;`),t.push("}"),t.push("")),this.cssVars.controlsBorderRadius&&(t.push("/* Playback Controls Container - Border Radius */"),t.push(".playback-controls {"),t.push(`  border-radius: 0 0 ${this.cssVars.controlsBorderRadius} ${this.cssVars.controlsBorderRadius} !important;`),t.push("}"),t.push("")),this.cssVars.controlsProgressBg&&(t.push("/* Progress Bar - Background */"),t.push(".playback-controls .progress-bar {"),t.push(`  background: ${this.cssVars.controlsProgressBg} !important;`),t.push("}"),t.push("")),this.cssVars.controlsProgressColor&&(t.push("/* Progress Fill - Color */"),t.push(".playback-controls .progress-fill {"),t.push(`  background: ${this.cssVars.controlsProgressColor} !important;`),t.push("}"),t.push("")),this.cssVars.controlsButtonSize&&(t.push("/* Control Button - Size */"),t.push(".playback-controls .control-button {"),t.push(`  width: ${this.cssVars.controlsButtonSize} !important;`),t.push(`  height: ${this.cssVars.controlsButtonSize} !important;`),t.push("}"),t.push("")),this.cssVars.controlsButtonBg&&(t.push("/* Control Button - Background */"),t.push(".playback-controls .control-button {"),t.push(`  background: ${this.cssVars.controlsButtonBg} !important;`),t.push("}"),t.push("")),this.cssVars.controlsButtonColor&&(t.push("/* Control Button - Color */"),t.push(".playback-controls .control-button {"),t.push(`  color: ${this.cssVars.controlsButtonColor} !important;`),t.push("}"),t.push("")),this.cssVars.controlsBorderRadius&&(t.push("/* Control Button - Border Radius */"),t.push(".playback-controls .control-button,"),t.push(".playback-controls .speed-button {"),t.push(`  border-radius: ${this.cssVars.controlsBorderRadius} !important;`),t.push("}"),t.push("")),this.cssVars.controlsButtonHoverBg&&(t.push("/* Control Button Hover - Background */"),t.push(".playback-controls .control-button:hover:not(:disabled) {"),t.push(`  background: ${this.cssVars.controlsButtonHoverBg} !important;`),t.push("}"),t.push("")),this.cssVars.controlsButtonHoverColor&&(t.push("/* Control Button Hover - Color */"),t.push(".playback-controls .control-button:hover:not(:disabled) {"),t.push(`  color: ${this.cssVars.controlsButtonHoverColor} !important;`),t.push("}"),t.push("")),this.cssVars.controlsPrimaryButtonSize&&(t.push("/* Primary Control Button - Size */"),t.push(".playback-controls .control-button.primary {"),t.push(`  width: ${this.cssVars.controlsPrimaryButtonSize} !important;`),t.push(`  height: ${this.cssVars.controlsPrimaryButtonSize} !important;`),t.push("}"),t.push("")),this.cssVars.overlayBackground&&(t.push("/* Overlay Background - Color */"),t.push(".dice-overlay,"),t.push(".scene-description-overlay {"),t.push(`  background: ${this.cssVars.overlayBackground} !important;`),t.push("}"),t.push("")),this.cssVars.overlayBlur&&(t.push("/* Overlay Background - Blur */"),t.push(".dice-overlay,"),t.push(".scene-description-overlay {"),t.push(`  backdrop-filter: blur(${this.cssVars.overlayBlur}) !important;`),t.push("}"),t.push("")),this.cssVars.overlayContentBackground&&(t.push("/* Overlay Content Box - Background */"),t.push(".dice-overlay-content,"),t.push(".scene-description-content {"),t.push(`  background: ${this.cssVars.overlayContentBackground} !important;`),t.push("}"),t.push("")),this.cssVars.overlayTextColor&&(t.push("/* Overlay Content Box - Text Color */"),t.push(".dice-overlay-content,"),t.push(".scene-description-content {"),t.push(`  color: ${this.cssVars.overlayTextColor} !important;`),t.push("}"),t.push("")),this.cssVars.overlayBorderRadius&&(t.push("/* Overlay Content Box - Border Radius */"),t.push(".dice-overlay-content,"),t.push(".scene-description-content {"),t.push(`  border-radius: ${this.cssVars.overlayBorderRadius} !important;`),t.push("}"),t.push("")),this.cssVars.overlayPadding&&(t.push("/* Overlay Content Box - Padding */"),t.push(".dice-overlay-content,"),t.push(".scene-description-content {"),t.push(`  padding: ${this.cssVars.overlayPadding} !important;`),t.push("}"),t.push("")),this.cssVars.overlayMaxWidth&&(t.push("/* Overlay Content Box - Max Width */"),t.push(".dice-overlay-content,"),t.push(".scene-description-content {"),t.push(`  max-width: ${this.cssVars.overlayMaxWidth} !important;`),t.push("}"),t.push("")),this.cssVars.globalBackground&&(t.push("/* Global Container - Background Color */"),t.push(".embed-player-view,"),t.push(".player-view {"),t.push(`  background-color: ${this.cssVars.globalBackground} !important;`),t.push("}"),t.push("")),this.cssVars.globalTextColor&&(t.push("/* Global - Text Color (All Elements) */"),t.push(".embed-player-view,"),t.push(".player-view,"),t.push(".embed-player-view *,"),t.push(".player-view * {"),t.push(`  color: ${this.cssVars.globalTextColor} !important;`),t.push("}"),t.push("")),this.cssVars.globalFontFamily&&(t.push("/* Global - Font Family (All Elements) */"),t.push(".embed-player-view,"),t.push(".player-view,"),t.push(".embed-player-view *,"),t.push(".player-view * {"),t.push(`  font-family: ${this.cssVars.globalFontFamily} !important;`),t.push("}"),t.push("")),this.cssVars.globalLineHeight&&(t.push("/* Global - Line Height (All Elements) */"),t.push(".embed-player-view,"),t.push(".player-view,"),t.push(".embed-player-view *,"),t.push(".player-view * {"),t.push(`  line-height: ${this.cssVars.globalLineHeight} !important;`),t.push("}"),t.push("")),this.cssVars.globalBackgroundImage&&this.cssVars.globalBackgroundImage!=="none"&&(t.push("/* Global Container - Background Image */"),t.push(".embed-player-view,"),t.push(".player-view {"),t.push(`  background-image: ${this.cssVars.globalBackgroundImage} !important;`),this.cssVars.globalBackgroundSize&&t.push(`  background-size: ${this.cssVars.globalBackgroundSize} !important;`),t.push("  background-position: center !important;"),t.push("  background-repeat: no-repeat !important;"),t.push("  background-attachment: fixed !important;"),t.push("}"),t.push("")),this.cssVars.controlsBackground&&(t.push("/* Player Header - Background */"),t.push(".player-view .player-header,"),t.push(".embed-player-view .player-header {"),t.push(`  background: ${this.cssVars.controlsBackground} !important;`),t.push("}"),t.push("")),this.cssVars.controlsBorderColor&&(t.push("/* Player Header - Border Color */"),t.push(".player-view .player-header,"),t.push(".embed-player-view .player-header {"),t.push(`  border-bottom-color: ${this.cssVars.controlsBorderColor} !important;`),t.push("}"),t.push("")),this.cssVars.controlsButtonBg&&(t.push("/* Header Back Button - Background */"),t.push(".player-view .player-header .back-button {"),t.push(`  background: ${this.cssVars.controlsButtonBg} !important;`),t.push("}"),t.push("")),this.cssVars.controlsButtonColor&&(t.push("/* Header Back Button - Color */"),t.push(".player-view .player-header .back-button {"),t.push(`  color: ${this.cssVars.controlsButtonColor} !important;`),t.push("}"),t.push("")),this.cssVars.controlsBorderRadius&&(t.push("/* Header Back Button - Border Radius */"),t.push(".player-view .player-header .back-button {"),t.push(`  border-radius: ${this.cssVars.controlsBorderRadius} !important;`),t.push("}"),t.push("")),this.cssVars.controlsButtonHoverBg&&(t.push("/* Header Back Button Hover - Background */"),t.push(".player-view .player-header .back-button:hover {"),t.push(`  background: ${this.cssVars.controlsButtonHoverBg} !important;`),t.push("}"),t.push("")),this.cssVars.controlsButtonBg&&(t.push("/* Header Buttons - Background */"),t.push(".player-view .player-header .header-button,"),t.push(".embed-player-view .player-header .header-button {"),t.push(`  background: ${this.cssVars.controlsButtonBg} !important;`),t.push("}"),t.push("")),this.cssVars.controlsButtonColor&&(t.push("/* Header Buttons - Color */"),t.push(".player-view .player-header .header-button,"),t.push(".embed-player-view .player-header .header-button {"),t.push(`  color: ${this.cssVars.controlsButtonColor} !important;`),t.push("}"),t.push("")),this.cssVars.controlsBorderRadius&&(t.push("/* Header Buttons - Border Radius */"),t.push(".player-view .player-header .header-button,"),t.push(".embed-player-view .player-header .header-button {"),t.push(`  border-radius: ${this.cssVars.controlsBorderRadius} !important;`),t.push("}"),t.push("")),this.cssVars.controlsButtonHoverBg&&(t.push("/* Header Buttons Hover - Background */"),t.push(".player-view .player-header .header-button:hover,"),t.push(".embed-player-view .player-header .header-button:hover {"),t.push(`  background: ${this.cssVars.controlsButtonHoverBg} !important;`),t.push("}"),t.push("")),this.cssVars.controlsButtonHoverColor&&(t.push("/* Header Buttons Hover - Color */"),t.push(".player-view .player-header .header-button:hover,"),t.push(".embed-player-view .player-header .header-button:hover {"),t.push(`  color: ${this.cssVars.controlsButtonHoverColor} !important;`),t.push("}"),t.push("")),this.cssVars.globalTextColor&&(t.push("/* Header Title - Color */"),t.push(".player-view .player-header .log-title,"),t.push(".embed-player-view .player-header .embed-title {"),t.push(`  color: ${this.cssVars.globalTextColor} !important;`),t.push("}"),t.push("")),t.join(`
`)},wrapCSSWithScope(t){const e=t.split(`
`),r=[];let h=!1,l=[],a=0;for(const i of e){const o=i.trim();if(o.startsWith("/*")){r.push(i);continue}if(o.includes("{")?(a+=(o.match(/{/g)||[]).length,!h&&a>0?(h=!0,l=[i]):l.push(i)):h||o&&!o.startsWith("/*")?l.push(i):r.push(i),o.includes("}")&&(a-=(o.match(/}/g)||[]).length,h&&a===0)){const v=l.join(`
`),n=this.applyScopeToRule(v);r.push(n),l=[],h=!1}}return r.join(`
`)},applyScopeToRule(t){const e=t.match(/^([^{]+){([\s\S]*)}/);if(!e)return t;const r=e[1].trim(),h=e[2];return r.includes(":root")?`.player-view, .embed-player-view, .mini-player-view {
${h}}`:`${r.split(",").map(i=>i.trim()).map(i=>i.startsWith(".player-view")||i.startsWith(".embed-player-view")||i.startsWith(".mini-player-view")?i:`.player-view ${i}, .embed-player-view ${i}, .mini-player-view ${i}`).join(", ")} {
${h}}`},updateCSSCodeText(){const t=this.generateCSSFile();this.cssCodeText=t+this.userCustomCSS},onCodeEdit(){},syncFromCode(){try{const t=this.cssCodeText,e="/* USER CUSTOM CSS - Add your styles below */",r=t.indexOf(e);let h=t,l="";r!==-1&&(h=t.substring(0,r+e.length),l=t.substring(r+e.length).trim()),this.parseCSSFile(h),this.userCustomCSS=l?`
`+l:"",this.applyPreview(),this.injectCustomStyleTag(),alert("CSS ì½”ë“œê°€ UIì— ë™ê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.")}catch(t){alert("CSS ì½”ë“œ íŒŒì‹± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."),console.error(t)}},async copyCodeToClipboard(){try{await navigator.clipboard.writeText(this.cssCodeText),alert("CSS ì½”ë“œê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.")}catch(t){alert("í´ë¦½ë³´ë“œ ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."),console.error(t)}},resetToDefault(){confirm("CSSë¥¼ ê¸°ë³¸ê°’ìœ¼ë¡œ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")&&(this.cssVars=this.getDefaultCSSVars(),this.applyPreview())},exportCSS(){const t=this.cssCodeText,e=new Blob([t],{type:"text/css"}),r=URL.createObjectURL(e),h=document.createElement("a");h.href=r,h.download=`vnlog-custom-${Date.now()}.css`,h.click(),URL.revokeObjectURL(r)},generateCSSFile(){return this.generateCSSVariableRules()+`

/* ======================================== */
/* USER CUSTOM CSS - Add your styles below */
/* ======================================== */
`},importCSS(){this.$refs.fileInput.click()},handleFileImport(t){const e=t.target.files[0];if(!e)return;const r=new FileReader;r.onload=h=>{try{const l=h.target.result,a="/* USER CUSTOM CSS - Add your styles below */",i=l.indexOf(a);let o=l,v="";i!==-1&&(o=l.substring(0,i+a.length),v=l.substring(i+a.length).trim()),this.parseCSSFile(o),this.userCustomCSS=v?`
`+v:"",this.updateCSSCodeText(),this.applyPreview(),alert("CSSë¥¼ ì„±ê³µì ìœ¼ë¡œ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤.")}catch(l){alert("CSS íŒŒì¼ì„ ì½ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."),console.error(l)}},r.readAsText(e),t.target.value=""},parseCSSFile(t){const e=t.split(`
`);for(const r of e){const h=r.trim();if(h.startsWith("--custom-")){const l=h.match(/--custom-([^:]+):\s*([^;]+);?/);if(l){const a=l[1].trim(),i=l[2].trim(),o=this.cssToCamelCase(a);this.cssVars.hasOwnProperty(o)&&(this.cssVars[o]=i)}}}console.log("[CustomCSSEditor] CSS íŒŒì‹± ì™„ë£Œ:",this.cssVars)},cssToCamelCase(t){return{"dialog-bg":"dialogBackground","dialog-border":"dialogBorderColor","dialog-text":"dialogTextColor","dialog-border-width":"dialogBorderWidth","dialog-name-size":"dialogNameFontSize","dialog-text-size":"dialogTextFontSize","dialog-padding":"dialogPadding","dialog-radius":"dialogBorderRadius","dialog-min-height":"dialogMinHeight","dialog-line-height":"dialogLineHeight","character-max-height":"characterMaxHeight","character-max-width":"characterMaxWidth","character-inactive-opacity":"characterInactiveOpacity","character-border-radius":"characterBorderRadius","character-border-width":"characterBorderWidth","character-transition":"characterTransition","controls-bg":"controlsBackground","controls-border":"controlsBorderColor","controls-button":"controlsButtonColor","controls-button-hover":"controlsButtonHoverColor","controls-button-bg":"controlsButtonBg","controls-button-hover-bg":"controlsButtonHoverBg","controls-progress":"controlsProgressColor","controls-progress-bg":"controlsProgressBg","controls-button-size":"controlsButtonSize","controls-primary-button-size":"controlsPrimaryButtonSize","controls-border-radius":"controlsBorderRadius","overlay-bg":"overlayBackground","overlay-blur":"overlayBlur","overlay-content-bg":"overlayContentBackground","overlay-text":"overlayTextColor","overlay-radius":"overlayBorderRadius","overlay-padding":"overlayPadding","overlay-max-width":"overlayMaxWidth","global-bg":"globalBackground","global-text":"globalTextColor","global-font":"globalFontFamily","global-line-height":"globalLineHeight"}[t]||t},applyAndSave(){this.$emit("save",{cssVars:this.cssVars,userCustomCSS:this.userCustomCSS}),alert("CSSê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤. JSON ë‚´ë³´ë‚´ê¸° ì‹œ í•¨ê»˜ í¬í•¨ë©ë‹ˆë‹¤.")}},mounted(){this.initialCSS&&(this.initialCSS.cssVars?this.cssVars={...this.getDefaultCSSVars(),...this.initialCSS.cssVars}:Object.keys(this.initialCSS).length>0&&(this.cssVars={...this.getDefaultCSSVars(),...this.initialCSS}),this.initialCSS.userCustomCSS&&(this.userCustomCSS=this.initialCSS.userCustomCSS)),this.updateCSSCodeText(),this.applyPreview()},beforeUnmount(){const t=document.getElementById("vnlog-custom-css");t&&t.remove()}},Va={class:"custom-css-editor"},Sa={class:"editor-header"},ka={class:"editor-body"},xa={class:"section-tabs"},wa=["onClick"],Ua={class:"editor-content"},Ba={key:0,class:"preview-section"},Da={class:"preview-content"},Ia={class:"css-edit-area"},Ta={key:0,class:"css-section"},_a={class:"css-field"},za={class:"css-field"},ja={class:"css-field"},Pa={class:"css-field"},Ea={class:"css-field"},Ra={class:"css-field"},Na={class:"css-field"},Oa={class:"css-field"},Fa={class:"css-field"},Aa={class:"css-field"},La={key:1,class:"css-section"},Ma={class:"css-field"},Ha={class:"css-field"},Ja={class:"css-field"},Ga={class:"css-field"},Wa={class:"css-field"},Xa={class:"css-field"},qa={key:2,class:"css-section"},Ka={class:"css-field"},Ya={class:"css-field"},Qa={class:"css-field"},Za={class:"css-field"},$a={class:"css-field"},ei={class:"css-field"},ti={class:"css-field"},si={class:"css-field"},li={class:"css-field"},oi={class:"css-field"},ai={class:"css-field"},ii={key:3,class:"css-section"},ri={class:"css-field"},ni={class:"css-field"},di={class:"css-field"},ui={class:"css-field"},ci={class:"css-field"},pi={class:"css-field"},hi={class:"css-field"},mi={key:4,class:"css-section"},fi={class:"css-field"},gi={class:"css-field"},vi={class:"css-field"},bi={class:"css-field"},yi={class:"css-field"},Ci={class:"css-field"},Vi={key:5,class:"css-section"},Si={class:"css-code-editor"},ki={class:"code-header"},xi={class:"code-actions"},wi={class:"code-hint"},Ui={class:"editor-actions"};function Bi(t,e,r,h,l,a){const i=x("EmojiToIcon"),o=x("EmbedPlayerView"),v=x("ColorPicker"),n=x("UnitInput");return c(),p("div",Va,[s("div",Sa,[s("h3",null,[d(i,{emoji:"ğŸ¨",size:20}),e[55]||(e[55]=m(" CSS ì»¤ìŠ¤í„°ë§ˆì´ì§• ",-1))]),e[56]||(e[56]=s("p",{class:"editor-description"}," í”Œë ˆì´ì–´ì˜ CSSë¥¼ ì§ì ‘ í¸ì§‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë³€ê²½ ì‚¬í•­ì€ ì‹¤ì‹œê°„ìœ¼ë¡œ ë¯¸ë¦¬ë³´ê¸°ì— ë°˜ì˜ë©ë‹ˆë‹¤. ",-1))]),s("div",ka,[s("div",xa,[(c(!0),p(k,null,U(l.sections,u=>(c(),p("button",{key:u.id,class:w(["section-tab",{active:l.currentSection===u.id}]),onClick:V=>l.currentSection=u.id},[d(i,{emoji:u.icon,size:16},null,8,["emoji"]),m(" "+y(u.name),1)],10,wa))),128))]),s("div",Ua,[l.currentSection!=="code"?(c(),p("div",Ba,[s("h4",null,[d(i,{emoji:"ğŸ‘ï¸",size:16}),e[57]||(e[57]=m(" ë¯¸ë¦¬ë³´ê¸° ",-1))]),s("div",Da,[d(o,{ref:"embedPlayerPreview","vn-data":a.mockVNData,"custom-css":{cssVars:l.cssVars,userCustomCSS:l.userCustomCSS}},null,8,["vn-data","custom-css"])])])):g("",!0),s("div",Ia,[l.currentSection==="dialog"?(c(),p("div",Ta,[e[68]||(e[68]=s("h4",null,"ëŒ€ì‚¬ ë°•ìŠ¤ (DialogBox)",-1)),s("div",_a,[e[58]||(e[58]=s("label",null,"ë°°ê²½ìƒ‰",-1)),d(v,{modelValue:l.cssVars.dialogBackground,"onUpdate:modelValue":[e[0]||(e[0]=u=>l.cssVars.dialogBackground=u),a.applyPreview],"supports-alpha":!0},null,8,["modelValue","onUpdate:modelValue"])]),s("div",za,[e[59]||(e[59]=s("label",null,"í…Œë‘ë¦¬ ìƒ‰ìƒ",-1)),d(v,{modelValue:l.cssVars.dialogBorderColor,"onUpdate:modelValue":[e[1]||(e[1]=u=>l.cssVars.dialogBorderColor=u),a.applyPreview],"supports-alpha":!0},null,8,["modelValue","onUpdate:modelValue"])]),s("div",ja,[e[60]||(e[60]=s("label",null,"í…Œë‘ë¦¬ ë‘ê»˜",-1)),d(n,{modelValue:l.cssVars.dialogBorderWidth,"onUpdate:modelValue":[e[2]||(e[2]=u=>l.cssVars.dialogBorderWidth=u),a.applyPreview],units:["px"],step:1},null,8,["modelValue","onUpdate:modelValue"])]),s("div",Pa,[e[61]||(e[61]=s("label",null,"í…ìŠ¤íŠ¸ ìƒ‰ìƒ",-1)),d(v,{modelValue:l.cssVars.dialogTextColor,"onUpdate:modelValue":[e[3]||(e[3]=u=>l.cssVars.dialogTextColor=u),a.applyPreview],"supports-alpha":!1},null,8,["modelValue","onUpdate:modelValue"])]),s("div",Ea,[e[62]||(e[62]=s("label",null,"ìºë¦­í„° ì´ë¦„ ê¸€ê¼´ í¬ê¸°",-1)),d(n,{modelValue:l.cssVars.dialogNameFontSize,"onUpdate:modelValue":[e[4]||(e[4]=u=>l.cssVars.dialogNameFontSize=u),a.applyPreview],units:["px","rem","em"],step:.1},null,8,["modelValue","onUpdate:modelValue"])]),s("div",Ra,[e[63]||(e[63]=s("label",null,"ëŒ€ì‚¬ ê¸€ê¼´ í¬ê¸°",-1)),d(n,{modelValue:l.cssVars.dialogTextFontSize,"onUpdate:modelValue":[e[5]||(e[5]=u=>l.cssVars.dialogTextFontSize=u),a.applyPreview],units:["px","rem","em"],step:.1},null,8,["modelValue","onUpdate:modelValue"])]),s("div",Na,[e[64]||(e[64]=s("label",null,"íŒ¨ë”©",-1)),d(n,{modelValue:l.cssVars.dialogPadding,"onUpdate:modelValue":[e[6]||(e[6]=u=>l.cssVars.dialogPadding=u),a.applyPreview],units:["px","rem","em"],step:.1},null,8,["modelValue","onUpdate:modelValue"])]),s("div",Oa,[e[65]||(e[65]=s("label",null,"ëª¨ì„œë¦¬ ë°˜ê²½",-1)),d(n,{modelValue:l.cssVars.dialogBorderRadius,"onUpdate:modelValue":[e[7]||(e[7]=u=>l.cssVars.dialogBorderRadius=u),a.applyPreview],units:["px","rem","%"],step:1},null,8,["modelValue","onUpdate:modelValue"])]),s("div",Fa,[e[66]||(e[66]=s("label",null,"ìµœì†Œ ë†’ì´",-1)),d(n,{modelValue:l.cssVars.dialogMinHeight,"onUpdate:modelValue":[e[8]||(e[8]=u=>l.cssVars.dialogMinHeight=u),a.applyPreview],units:["px","rem"],step:1},null,8,["modelValue","onUpdate:modelValue"])]),s("div",Aa,[e[67]||(e[67]=s("label",null,"ì¤„ ê°„ê²©",-1)),f(s("input",{type:"text","onUpdate:modelValue":e[9]||(e[9]=u=>l.cssVars.dialogLineHeight=u),onInput:e[10]||(e[10]=(...u)=>a.applyPreview&&a.applyPreview(...u)),placeholder:"1.8"},null,544),[[b,l.cssVars.dialogLineHeight]])])])):g("",!0),l.currentSection==="character"?(c(),p("div",La,[e[75]||(e[75]=s("h4",null,"ìºë¦­í„° í‘œì‹œ (CharacterDisplay)",-1)),s("div",Ma,[e[69]||(e[69]=s("label",null,"ìºë¦­í„° ì´ë¯¸ì§€ ìµœëŒ€ ë†’ì´",-1)),d(n,{modelValue:l.cssVars.characterMaxHeight,"onUpdate:modelValue":[e[11]||(e[11]=u=>l.cssVars.characterMaxHeight=u),a.applyPreview],units:["vh","px","%"],step:1},null,8,["modelValue","onUpdate:modelValue"])]),s("div",Ha,[e[70]||(e[70]=s("label",null,"ìºë¦­í„° ì´ë¯¸ì§€ ìµœëŒ€ ë„ˆë¹„",-1)),d(n,{modelValue:l.cssVars.characterMaxWidth,"onUpdate:modelValue":[e[12]||(e[12]=u=>l.cssVars.characterMaxWidth=u),a.applyPreview],units:["px","%","vw"],step:1},null,8,["modelValue","onUpdate:modelValue"])]),s("div",Ja,[e[71]||(e[71]=s("label",null,"ìºë¦­í„° íˆ¬ëª…ë„ (ë¹„í™œì„±)",-1)),f(s("input",{type:"range","onUpdate:modelValue":e[13]||(e[13]=u=>l.cssVars.characterInactiveOpacity=u),onInput:e[14]||(e[14]=(...u)=>a.applyPreview&&a.applyPreview(...u)),min:"0",max:"1",step:"0.05"},null,544),[[b,l.cssVars.characterInactiveOpacity]]),s("span",null,y(l.cssVars.characterInactiveOpacity),1)]),s("div",Ga,[e[72]||(e[72]=s("label",null,"ëª¨ì„œë¦¬ ë°˜ê²½",-1)),d(n,{modelValue:l.cssVars.characterBorderRadius,"onUpdate:modelValue":[e[15]||(e[15]=u=>l.cssVars.characterBorderRadius=u),a.applyPreview],units:["px","rem","%"],step:1},null,8,["modelValue","onUpdate:modelValue"])]),s("div",Wa,[e[73]||(e[73]=s("label",null,"í…Œë‘ë¦¬ ë‘ê»˜",-1)),d(n,{modelValue:l.cssVars.characterBorderWidth,"onUpdate:modelValue":[e[16]||(e[16]=u=>l.cssVars.characterBorderWidth=u),a.applyPreview],units:["px"],step:1},null,8,["modelValue","onUpdate:modelValue"])]),s("div",Xa,[e[74]||(e[74]=s("label",null,"ìºë¦­í„° ì „í™˜ ì‹œê°„",-1)),d(n,{modelValue:l.cssVars.characterTransition,"onUpdate:modelValue":[e[17]||(e[17]=u=>l.cssVars.characterTransition=u),a.applyPreview],units:["s","ms"],step:.1},null,8,["modelValue","onUpdate:modelValue"])])])):g("",!0),l.currentSection==="controls"?(c(),p("div",qa,[e[87]||(e[87]=s("h4",null,"ì¬ìƒ ì»¨íŠ¸ë¡¤ (PlaybackControls)",-1)),s("div",Ka,[e[76]||(e[76]=s("label",null,"ì»¨íŠ¸ë¡¤ ë°°ê²½ìƒ‰",-1)),d(v,{modelValue:l.cssVars.controlsBackground,"onUpdate:modelValue":[e[18]||(e[18]=u=>l.cssVars.controlsBackground=u),a.applyPreview],"supports-alpha":!0},null,8,["modelValue","onUpdate:modelValue"])]),s("div",Ya,[e[77]||(e[77]=s("label",null,"ì»¨íŠ¸ë¡¤ í…Œë‘ë¦¬ ìƒ‰ìƒ",-1)),d(v,{modelValue:l.cssVars.controlsBorderColor,"onUpdate:modelValue":[e[19]||(e[19]=u=>l.cssVars.controlsBorderColor=u),a.applyPreview],"supports-alpha":!0},null,8,["modelValue","onUpdate:modelValue"])]),s("div",Qa,[e[78]||(e[78]=s("label",null,"ë²„íŠ¼ ë°°ê²½ìƒ‰",-1)),d(v,{modelValue:l.cssVars.controlsButtonBg,"onUpdate:modelValue":[e[20]||(e[20]=u=>l.cssVars.controlsButtonBg=u),a.applyPreview],"supports-alpha":!0},null,8,["modelValue","onUpdate:modelValue"])]),s("div",Za,[e[79]||(e[79]=s("label",null,"ë²„íŠ¼ í˜¸ë²„ ë°°ê²½ìƒ‰",-1)),d(v,{modelValue:l.cssVars.controlsButtonHoverBg,"onUpdate:modelValue":[e[21]||(e[21]=u=>l.cssVars.controlsButtonHoverBg=u),a.applyPreview],"supports-alpha":!0},null,8,["modelValue","onUpdate:modelValue"])]),s("div",$a,[e[80]||(e[80]=s("label",null,"ë²„íŠ¼ ì•„ì´ì½˜ ìƒ‰ìƒ",-1)),d(v,{modelValue:l.cssVars.controlsButtonColor,"onUpdate:modelValue":[e[22]||(e[22]=u=>l.cssVars.controlsButtonColor=u),a.applyPreview],"supports-alpha":!1},null,8,["modelValue","onUpdate:modelValue"])]),s("div",ei,[e[81]||(e[81]=s("label",null,"ë²„íŠ¼ í˜¸ë²„ ì•„ì´ì½˜ ìƒ‰ìƒ",-1)),d(v,{modelValue:l.cssVars.controlsButtonHoverColor,"onUpdate:modelValue":[e[23]||(e[23]=u=>l.cssVars.controlsButtonHoverColor=u),a.applyPreview],"supports-alpha":!1},null,8,["modelValue","onUpdate:modelValue"])]),s("div",ti,[e[82]||(e[82]=s("label",null,"ì§„í–‰ ë°” ìƒ‰ìƒ",-1)),d(v,{modelValue:l.cssVars.controlsProgressColor,"onUpdate:modelValue":[e[24]||(e[24]=u=>l.cssVars.controlsProgressColor=u),a.applyPreview],"supports-alpha":!1},null,8,["modelValue","onUpdate:modelValue"])]),s("div",si,[e[83]||(e[83]=s("label",null,"ì§„í–‰ ë°” ë°°ê²½ìƒ‰",-1)),d(v,{modelValue:l.cssVars.controlsProgressBg,"onUpdate:modelValue":[e[25]||(e[25]=u=>l.cssVars.controlsProgressBg=u),a.applyPreview],"supports-alpha":!0},null,8,["modelValue","onUpdate:modelValue"])]),s("div",li,[e[84]||(e[84]=s("label",null,"ë²„íŠ¼ í¬ê¸°",-1)),d(n,{modelValue:l.cssVars.controlsButtonSize,"onUpdate:modelValue":[e[26]||(e[26]=u=>l.cssVars.controlsButtonSize=u),a.applyPreview],units:["px","rem"],step:1},null,8,["modelValue","onUpdate:modelValue"])]),s("div",oi,[e[85]||(e[85]=s("label",null,"ì£¼ ë²„íŠ¼ í¬ê¸°",-1)),d(n,{modelValue:l.cssVars.controlsPrimaryButtonSize,"onUpdate:modelValue":[e[27]||(e[27]=u=>l.cssVars.controlsPrimaryButtonSize=u),a.applyPreview],units:["px","rem"],step:1},null,8,["modelValue","onUpdate:modelValue"])]),s("div",ai,[e[86]||(e[86]=s("label",null,"ë²„íŠ¼ ëª¨ì„œë¦¬ ë°˜ê²½",-1)),d(n,{modelValue:l.cssVars.controlsBorderRadius,"onUpdate:modelValue":[e[28]||(e[28]=u=>l.cssVars.controlsBorderRadius=u),a.applyPreview],units:["px","rem","%"],step:1},null,8,["modelValue","onUpdate:modelValue"])])])):g("",!0),l.currentSection==="overlay"?(c(),p("div",ii,[e[95]||(e[95]=s("h4",null,"ì˜¤ë²„ë ˆì´ (ë‹¤ì´ìŠ¤, ì½¤ë³´, ì”¬ ì„¤ëª…)",-1)),s("div",ri,[e[88]||(e[88]=s("label",null,"ì˜¤ë²„ë ˆì´ ë°°ê²½ìƒ‰",-1)),d(v,{modelValue:l.cssVars.overlayBackground,"onUpdate:modelValue":[e[29]||(e[29]=u=>l.cssVars.overlayBackground=u),a.applyPreview],"supports-alpha":!0},null,8,["modelValue","onUpdate:modelValue"])]),s("div",ni,[e[89]||(e[89]=s("label",null,"ì˜¤ë²„ë ˆì´ ë¸”ëŸ¬",-1)),d(n,{modelValue:l.cssVars.overlayBlur,"onUpdate:modelValue":[e[30]||(e[30]=u=>l.cssVars.overlayBlur=u),a.applyPreview],units:["px"],step:1},null,8,["modelValue","onUpdate:modelValue"])]),s("div",di,[e[90]||(e[90]=s("label",null,"ì˜¤ë²„ë ˆì´ ì½˜í…ì¸  ë°°ê²½",-1)),d(v,{modelValue:l.cssVars.overlayContentBackground,"onUpdate:modelValue":[e[31]||(e[31]=u=>l.cssVars.overlayContentBackground=u),a.applyPreview],"supports-alpha":!0},null,8,["modelValue","onUpdate:modelValue"])]),s("div",ui,[e[91]||(e[91]=s("label",null,"ì˜¤ë²„ë ˆì´ í…ìŠ¤íŠ¸ ìƒ‰ìƒ",-1)),d(v,{modelValue:l.cssVars.overlayTextColor,"onUpdate:modelValue":[e[32]||(e[32]=u=>l.cssVars.overlayTextColor=u),a.applyPreview],"supports-alpha":!1},null,8,["modelValue","onUpdate:modelValue"])]),s("div",ci,[e[92]||(e[92]=s("label",null,"ì½˜í…ì¸  ëª¨ì„œë¦¬ ë°˜ê²½",-1)),d(n,{modelValue:l.cssVars.overlayBorderRadius,"onUpdate:modelValue":[e[33]||(e[33]=u=>l.cssVars.overlayBorderRadius=u),a.applyPreview],units:["px","rem"],step:1},null,8,["modelValue","onUpdate:modelValue"])]),s("div",pi,[e[93]||(e[93]=s("label",null,"ì½˜í…ì¸  íŒ¨ë”©",-1)),d(n,{modelValue:l.cssVars.overlayPadding,"onUpdate:modelValue":[e[34]||(e[34]=u=>l.cssVars.overlayPadding=u),a.applyPreview],units:["px","rem"],step:1},null,8,["modelValue","onUpdate:modelValue"])]),s("div",hi,[e[94]||(e[94]=s("label",null,"ì½˜í…ì¸  ìµœëŒ€ ë„ˆë¹„",-1)),d(n,{modelValue:l.cssVars.overlayMaxWidth,"onUpdate:modelValue":[e[35]||(e[35]=u=>l.cssVars.overlayMaxWidth=u),a.applyPreview],units:["px","%","vw"],step:10},null,8,["modelValue","onUpdate:modelValue"])])])):g("",!0),l.currentSection==="global"?(c(),p("div",mi,[e[104]||(e[104]=s("h4",null,"ì „ì—­ ìŠ¤íƒ€ì¼",-1)),s("div",fi,[e[96]||(e[96]=s("label",null,"ë©”ì¸ ë°°ê²½ìƒ‰",-1)),d(v,{modelValue:l.cssVars.globalBackground,"onUpdate:modelValue":[e[36]||(e[36]=u=>l.cssVars.globalBackground=u),a.applyPreview],"supports-alpha":!1},null,8,["modelValue","onUpdate:modelValue"])]),s("div",gi,[e[97]||(e[97]=s("label",null,"ê¸°ë³¸ í…ìŠ¤íŠ¸ ìƒ‰ìƒ",-1)),d(v,{modelValue:l.cssVars.globalTextColor,"onUpdate:modelValue":[e[37]||(e[37]=u=>l.cssVars.globalTextColor=u),a.applyPreview],"supports-alpha":!1},null,8,["modelValue","onUpdate:modelValue"])]),s("div",vi,[e[99]||(e[99]=s("label",null,"í°íŠ¸ íŒ¨ë°€ë¦¬",-1)),f(s("select",{"onUpdate:modelValue":e[38]||(e[38]=u=>l.cssVars.globalFontFamily=u),onChange:e[39]||(e[39]=(...u)=>a.applyPreview&&a.applyPreview(...u))},[...e[98]||(e[98]=[s("option",{value:"var(--font-pretendard)"},"Pretendard (ê¸°ë³¸)",-1),s("option",{value:"var(--font-nanum-square)"},"ë‚˜ëˆ”ìŠ¤í€˜ì–´",-1),s("option",{value:"var(--font-nanum-myeongjo)"},"ë‚˜ëˆ”ëª…ì¡°",-1),s("option",{value:"var(--font-noto-serif)"},"Noto Serif KR",-1)])],544),[[z,l.cssVars.globalFontFamily]])]),s("div",bi,[e[100]||(e[100]=s("label",null,"ê¸°ë³¸ ì¤„ ê°„ê²©",-1)),f(s("input",{type:"text","onUpdate:modelValue":e[40]||(e[40]=u=>l.cssVars.globalLineHeight=u),onInput:e[41]||(e[41]=(...u)=>a.applyPreview&&a.applyPreview(...u)),placeholder:"1.5"},null,544),[[b,l.cssVars.globalLineHeight]])]),s("div",yi,[e[101]||(e[101]=s("label",null,"ë°°ê²½ ì´ë¯¸ì§€ URL",-1)),f(s("input",{type:"text","onUpdate:modelValue":e[42]||(e[42]=u=>l.cssVars.globalBackgroundImage=u),onInput:e[43]||(e[43]=(...u)=>a.applyPreview&&a.applyPreview(...u)),placeholder:"url(https://...)"},null,544),[[b,l.cssVars.globalBackgroundImage]])]),s("div",Ci,[e[103]||(e[103]=s("label",null,"ë°°ê²½ ì´ë¯¸ì§€ í¬ê¸°",-1)),f(s("select",{"onUpdate:modelValue":e[44]||(e[44]=u=>l.cssVars.globalBackgroundSize=u),onChange:e[45]||(e[45]=(...u)=>a.applyPreview&&a.applyPreview(...u))},[...e[102]||(e[102]=[s("option",{value:"cover"},"ë®ê¸° (Cover)",-1),s("option",{value:"contain"},"ë§ì¶”ê¸° (Contain)",-1),s("option",{value:"auto"},"ìë™ (Auto)",-1),s("option",{value:"100% 100%"},"ëŠ˜ì´ê¸° (100% 100%)",-1)])],544),[[z,l.cssVars.globalBackgroundSize]])])])):g("",!0),l.currentSection==="code"?(c(),p("div",Vi,[e[109]||(e[109]=s("h4",null,"CSS ì½”ë“œ ì§ì ‘ í¸ì§‘",-1)),s("div",Si,[s("div",ki,[e[107]||(e[107]=s("span",{class:"code-label"},"ìƒì„±ëœ CSS ì½”ë“œ",-1)),s("div",xi,[s("button",{onClick:e[46]||(e[46]=(...u)=>a.syncFromCode&&a.syncFromCode(...u)),class:"btn-sync",title:"ì½”ë“œì—ì„œ UIë¡œ ë™ê¸°í™”"},[d(i,{emoji:"ğŸ”„",size:14}),e[105]||(e[105]=m(" ë™ê¸°í™” ",-1))]),s("button",{onClick:e[47]||(e[47]=(...u)=>a.copyCodeToClipboard&&a.copyCodeToClipboard(...u)),class:"btn-copy-code",title:"ì½”ë“œ ë³µì‚¬"},[d(i,{emoji:"ğŸ“‹",size:14}),e[106]||(e[106]=m(" ë³µì‚¬ ",-1))])])]),f(s("textarea",{"onUpdate:modelValue":e[48]||(e[48]=u=>l.cssCodeText=u),class:"css-textarea",spellcheck:"false",onInput:e[49]||(e[49]=(...u)=>a.onCodeEdit&&a.onCodeEdit(...u))},null,544),[[b,l.cssCodeText]]),s("p",wi,[d(i,{emoji:"ğŸ’¡",size:14}),e[108]||(e[108]=m(" ì´ ì½”ë“œë¥¼ ì§ì ‘ ìˆ˜ì •í•œ í›„ 'ë™ê¸°í™”' ë²„íŠ¼ì„ ëˆŒëŸ¬ UIì— ë°˜ì˜í•˜ì„¸ìš”. ",-1))])])])):g("",!0)])]),s("div",Ui,[s("button",{onClick:e[50]||(e[50]=(...u)=>a.resetToDefault&&a.resetToDefault(...u)),class:"btn-reset"},[d(i,{emoji:"ğŸ”„",size:16}),e[110]||(e[110]=m(" ê¸°ë³¸ê°’ìœ¼ë¡œ ì´ˆê¸°í™” ",-1))]),s("button",{onClick:e[51]||(e[51]=(...u)=>a.exportCSS&&a.exportCSS(...u)),class:"btn-export"},[d(i,{emoji:"ğŸ’¾",size:16}),e[111]||(e[111]=m(" CSS ë‚´ë³´ë‚´ê¸° ",-1))]),s("button",{onClick:e[52]||(e[52]=(...u)=>a.importCSS&&a.importCSS(...u)),class:"btn-import"},[d(i,{emoji:"ğŸ“‚",size:16}),e[112]||(e[112]=m(" CSS ë¶ˆëŸ¬ì˜¤ê¸° ",-1))]),s("button",{onClick:e[53]||(e[53]=(...u)=>a.applyAndSave&&a.applyAndSave(...u)),class:"btn-save"},[d(i,{emoji:"âœ…",size:16}),e[113]||(e[113]=m(" ì ìš© ë° ì €ì¥ ",-1))])])]),s("input",{ref:"fileInput",type:"file",accept:".css",style:{display:"none"},onChange:e[54]||(e[54]=(...u)=>a.handleFileImport&&a.handleFileImport(...u))},null,544)])}const Di=D(Ca,[["render",Bi],["__scopeId","data-v-7e778c86"]]),Ii={name:"EditorView",components:{StepEffectsEditor:Ce,StepInfoEditor:ol,CharacterBulkEditor:eo,ImageBulkEditor:sa,CustomCSSEditor:Di,DialogBox:A,CharacterDisplay:F,PlaybackControls:O},setup(){return{logStore:R()}},data(){return{activeTab:"info",selectedStepIndex:null,showEmbedModal:!1,embedJsonUrl:"https://ohohod.github.io/embeded-test.json",embedAutoplay:!1,embedCopied:!1,embedPreviewLoaded:!1}},computed:{allSteps(){var r;const t=[];return(((r=this.logStore.vnData)==null?void 0:r.scenes)||[]).forEach(h=>{t.push(...h.steps||[])}),t},totalSteps(){return this.allSteps.length},selectedStep(){return this.selectedStepIndex===null?null:this.allSteps[this.selectedStepIndex]||null},selectedStepEffects(){var t;return((t=this.selectedStep)==null?void 0:t.effects)||null},generatedEmbedCode(){if(!this.embedJsonUrl)return"<!-- JSON URLì„ ì…ë ¥í•˜ì„¸ìš” -->";const t=window.location.origin,e="/vnlog/",r=this.embedAutoplay?"&autoplay=true":"";return`<iframe src="${`${t}${e}embed?json=${encodeURIComponent(this.embedJsonUrl)}${r}`}" width="800" height="600" frameborder="0" allowfullscreen></iframe>`},embedPreviewUrl(){if(!this.embedJsonUrl)return"";const t=window.location.origin,e="/vnlog/",r=this.embedAutoplay?"&autoplay=true":"";return`${t}${e}embed?json=${encodeURIComponent(this.embedJsonUrl)}${r}`}},methods:{selectStep(t){this.selectedStepIndex=t},goBack(){this.$router.push("/player")},saveAndPlay(){this.saveToLocalStorage(),this.selectedStepIndex!==null&&sessionStorage.setItem("player-target-step",this.selectedStepIndex+1),this.$router.push("/player")},showEmbedCodeModal(){this.showEmbedModal=!0,this.embedCopied=!1,this.embedPreviewLoaded=!1},closeEmbedModal(){this.showEmbedModal=!1},async copyEmbedCode(){if(!this.embedJsonUrl){alert("JSON URLì„ ë¨¼ì € ì…ë ¥í•˜ì„¸ìš”.");return}try{await navigator.clipboard.writeText(this.generatedEmbedCode),this.embedCopied=!0,setTimeout(()=>{this.embedCopied=!1},2e3)}catch(t){console.error("í´ë¦½ë³´ë“œ ë³µì‚¬ ì‹¤íŒ¨:",t),alert("í´ë¦½ë³´ë“œ ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}},exportJSON(){const t=this.logStore.vnData;if(!t){alert("ë‚´ë³´ë‚¼ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.");return}const e=localStorage.getItem("vnlog-theme-settings");let r=null;if(e)try{r=JSON.parse(e)}catch(v){console.warn("í…Œë§ˆ ì„¤ì • íŒŒì‹± ì‹¤íŒ¨:",v)}const h={vnData:t,theme:r,exportedAt:new Date().toISOString(),version:"1.0.0"},l=JSON.stringify(h,null,2),a=new Blob([l],{type:"application/json"}),i=URL.createObjectURL(a),o=document.createElement("a");o.href=i,o.download=`${t.title||"vnlog"}_edited.json`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i),console.log("[EditorView] JSON ë‚´ë³´ë‚´ê¸° ì™„ë£Œ (customCSS í¬í•¨:",!!t.customCSS,")")},saveToLocalStorage(){try{const t=this.logStore.vnData;localStorage.setItem("vnlog-edited-data",JSON.stringify(t))}catch(t){console.error("ë¡œì»¬ìŠ¤í† ë¦¬ì§€ ì €ì¥ ì‹¤íŒ¨:",t)}},handleSaveStepInfo({id:t,updates:e}){const r=this.allSteps.find(h=>h.id===t);if(!r){alert("ìŠ¤í…ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");return}r.sceneNumber=e.sceneNumber,r.type=e.type,r.character.name=e.character.name,r.character.color=e.character.color,r.character.avatarUrl=e.character.avatarUrl,r.text=e.text,r.isSceneDescription=e.isSceneDescription,r.sceneTitle=e.sceneTitle,r.scenePCs=e.scenePCs,r.sceneDescription=e.sceneDescription,r.illustrations=JSON.parse(JSON.stringify(e.illustrations||[])),r.diceRolls=JSON.parse(JSON.stringify(e.diceRolls||[])),r.statusChanges=JSON.parse(JSON.stringify(e.statusChanges||[])),r.dxCombos=JSON.parse(JSON.stringify(e.dxCombos||[])),r.effects=JSON.parse(JSON.stringify(e.effects||{})),r.hasDice=e.hasDice,r.hasStatusChange=e.hasStatusChange,r.hasDXCombo=e.hasDXCombo,r.hasIllustration=e.hasIllustration,this.saveToLocalStorage(),alert("ìŠ¤í… ì •ë³´ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.")},handleApplyIllustrationsRange({startStep:t,endStep:e,illustrations:r}){var a;const h=this.allSteps,l=r||[];for(let i=t-1;i<e&&i<h.length;i++){const o=h[i];o.illustrations=JSON.parse(JSON.stringify(l)),o.hasIllustration=(((a=o.illustrations)==null?void 0:a.length)||0)>0}this.saveToLocalStorage(),alert(`ìŠ¤í… ${t}~${e}ì— ì¼ëŸ¬ìŠ¤íŠ¸ê°€ ì ìš©ë˜ì—ˆìŠµë‹ˆë‹¤.`)},handleDeleteStep(t){const e=this.logStore.vnData.scenes;let r=!1;for(let l=0;l<e.length;l++){const a=e[l],i=a.steps.findIndex(o=>o.id===t);if(i!==-1){a.steps.splice(i,1),r=!0;break}}if(!r){alert("ìŠ¤í…ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");return}const h=this.allSteps.length;this.selectedStepIndex>=h&&(this.selectedStepIndex=h>0?h-1:null),this.saveToLocalStorage(),alert("ìŠ¤í…ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.")},handleDuplicateStep(t){const e=this.logStore.vnData.scenes;let r=!1,h=0;const a=(Math.max(...this.allSteps.map(i=>parseInt(i.id)||0))+1).toString();for(let i=0;i<e.length;i++){const o=e[i],v=o.steps.findIndex(n=>n.id===t);if(v!==-1){const n=o.steps[v],u=JSON.parse(JSON.stringify(n));u.id=a,o.steps.splice(v+1,0,u);for(let V=0;V<i;V++)h+=e[V].steps.length;h+=v+1,r=!0;break}h+=o.steps.length}if(!r){alert("ìŠ¤í…ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");return}this.selectedStepIndex=h,this.saveToLocalStorage(),alert(`ìŠ¤í…ì´ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤. (ìƒˆ ID: ${a})`)},handleApplyEffects({startStep:t,endStep:e,effects:r}){const h=this.allSteps;for(let l=t-1;l<e&&l<h.length;l++){const a=h[l];a.effects&&(a.effects.sfx=r.sfx,a.effects.bgm=r.bgm,a.effects.background=r.background,a.effects.backgroundOpacity=r.backgroundOpacity)}this.saveToLocalStorage(),alert(`ìŠ¤í… ${t}~${e}ì— íš¨ê³¼ê°€ ì ìš©ë˜ì—ˆìŠµë‹ˆë‹¤.`)},handleRemoveEffects({startStep:t,endStep:e}){const r=this.allSteps;for(let h=t-1;h<e&&h<r.length;h++){const l=r[h];l.effects&&(l.effects.sfx=null,l.effects.bgm=null,l.effects.background=null)}this.saveToLocalStorage(),alert(`ìŠ¤í… ${t}~${e}ì˜ íš¨ê³¼ê°€ ì œê±°ë˜ì—ˆìŠµë‹ˆë‹¤.`)},async handleBulkUpdateCharacter({oldName:t,newName:e,newColor:r,convertToNarrator:h,onProgress:l,onComplete:a}){let i=0,o=0,v=0;this.allSteps.forEach(n=>{n.character&&n.character.name===t&&o++});for(let n=0;n<this.allSteps.length;n++){const u=this.allSteps[n];u.character&&u.character.name===t&&(h&&u.type!=="narrator"&&(u.type="narrator",v++),u.character.name=e,u.character.color=r,i++,l&&l(i,o),i%10===0&&await new Promise(V=>setTimeout(V,10)))}if(this.saveToLocalStorage(),a){const n=[];t!==e?n.push(`ì´ë¦„: "${t}" â†’ "${e}"`):n.push(`ìºë¦­í„°: "${t}"`),n.push(`ì ìš© ìŠ¤í…: ${i}ê°œ`),h&&n.push(`ë‚˜ë ˆì´í„° ë³€í™˜: ${v}ê°œ ìŠ¤í…`),await a({success:!0,updatedCount:i,message:n.join(`
`)})}},async handleBulkUpdateImage({oldUrl:t,newUrl:e,onProgress:r,onComplete:h}){var o,v;let l=0,a=0;const i=this.logStore.vnData;if(i.scenes&&i.scenes.forEach(n=>{var u;(u=n.steps)==null||u.forEach(V=>{var S,B;((S=V.character)==null?void 0:S.avatarUrl)===t&&a++,((B=V.effects)==null?void 0:B.background)===t&&a++,V.illustrations&&Array.isArray(V.illustrations)&&V.illustrations.forEach(C=>{C.url===t&&a++})})}),i.handouts&&i.handouts.forEach(n=>{n.imageUrl===t&&a++}),i.scenes)for(let n=0;n<i.scenes.length;n++){const u=i.scenes[n];if(u.steps)for(let V=0;V<u.steps.length;V++){const S=u.steps[V];if(((o=S.character)==null?void 0:o.avatarUrl)===t&&(S.character.avatarUrl=e,l++,r&&r(l,a)),((v=S.effects)==null?void 0:v.background)===t&&(S.effects.background=e,l++,r&&r(l,a)),S.illustrations&&Array.isArray(S.illustrations))for(let B=0;B<S.illustrations.length;B++){const C=S.illustrations[B];C.url===t&&(C.url=e,l++,r&&r(l,a))}l%10===0&&await new Promise(B=>setTimeout(B,10))}}if(i.characters)for(const n in i.characters){const u=i.characters[n];u.avatarUrl===t&&(u.avatarUrl=e)}if(i.handouts)for(let n=0;n<i.handouts.length;n++){const u=i.handouts[n];u.imageUrl===t&&(u.imageUrl=e,l++,r&&r(l,a),l%10===0&&await new Promise(V=>setTimeout(V,10)))}this.saveToLocalStorage(),h&&await h({success:!0,updatedCount:l,message:`ì´ë¯¸ì§€ URLì´ ì¼ê´„ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.
ì´ ${l}ê°œ í•­ëª©ì´ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤.`})},hasEffects(t){return t.effects&&(t.effects.sfx||t.effects.bgm||t.effects.background)},handleSaveCustomCSS(t){this.logStore.vnData||(this.logStore.vnData={}),this.logStore.vnData.customCSS=t,this.saveToLocalStorage(),console.log("[EditorView] customCSS ì €ì¥ ì™„ë£Œ:",t)},truncateText(t,e){return t?t.length>e?t.substring(0,e)+"...":t:""},scrollToTargetStep(){const t=sessionStorage.getItem("editor-target-step");if(t){const e=parseInt(t,10);if(e>=1&&e<=this.totalSteps){const r=e-1;this.$nextTick(()=>{this.selectStep(r);const h=document.querySelectorAll(".step-item");h[r]&&h[r].scrollIntoView({behavior:"smooth",block:"center"})})}sessionStorage.removeItem("editor-target-step")}}},mounted(){if(!this.logStore.vnData){this.$router.push("/");return}this.scrollToTargetStep()},beforeUnmount(){},watch:{activeTab(t,e){e==="css"&&t!=="css"&&(this.cssPreviewAutoPlay=!1)}}},Ti={class:"editor-view"},_i={class:"editor-container"},zi={class:"editor-header"},ji={class:"header-actions"},Pi={class:"modal-header"},Ei={class:"modal-body"},Ri={class:"embed-step"},Ni={class:"hosting-guide"},Oi={class:"hosting-option recommended"},Fi={class:"hosting-option tip"},Ai={class:"hosting-option warning"},Li={class:"embed-step"},Mi={class:"embed-step"},Hi={class:"embed-options"},Ji={class:"option-item"},Gi={class:"embed-step"},Wi={class:"code-preview"},Xi={key:0,class:"embed-preview-section"},qi={class:"embed-preview-frame"},Ki={key:0,class:"preview-loading"},Yi=["src"],Qi={class:"help-text-small"},Zi={key:0,class:"help-text-small"},$i={class:"editor-content"},er={key:0,class:"steps-list"},tr={class:"list-header"},sr={class:"list-body"},lr=["onClick"],or={class:"step-number"},ar={class:"step-info"},ir={class:"step-character"},rr={class:"step-text"},nr={key:0,class:"step-effects-tags"},dr={key:0,class:"effect-tag sfx"},ur={key:1,class:"effect-tag bgm"},cr={key:2,class:"effect-tag bg"},pr={class:"editor-panel"},hr={class:"tab-header"},mr={class:"tab-content"},fr={key:0,class:"tab-pane"},gr={key:1,class:"tab-pane"},vr={key:2,class:"tab-pane"},br={key:3,class:"tab-pane"},yr={key:4,class:"tab-pane"};function Cr(t,e,r,h,l,a){var S,B;const i=x("EmojiToIcon"),o=x("StepInfoEditor"),v=x("StepEffectsEditor"),n=x("CharacterBulkEditor"),u=x("ImageBulkEditor"),V=x("CustomCSSEditor");return c(),p("div",Ti,[s("div",_i,[s("header",zi,[s("button",{onClick:e[0]||(e[0]=(...C)=>a.goBack&&a.goBack(...C)),class:"back-button"},[d(i,{emoji:"â¬…ï¸",size:20})]),s("h2",null,[d(i,{emoji:"âœï¸",size:24}),e[21]||(e[21]=m(" ë¡œê·¸ í¸ì§‘ê¸° ",-1))]),s("div",ji,[s("button",{onClick:e[1]||(e[1]=(...C)=>a.showEmbedCodeModal&&a.showEmbedCodeModal(...C)),class:"embed-button"},[d(i,{emoji:"ğŸ”—",size:18}),e[22]||(e[22]=m(" ì„ë² ë“œ ì½”ë“œ ",-1))]),s("button",{onClick:e[2]||(e[2]=(...C)=>a.exportJSON&&a.exportJSON(...C)),class:"export-button"},[d(i,{emoji:"ğŸ“¤",size:18}),e[23]||(e[23]=m(" JSON ë‚´ë³´ë‚´ê¸° ",-1))]),s("button",{onClick:e[3]||(e[3]=(...C)=>a.saveAndPlay&&a.saveAndPlay(...C)),class:"save-button"},[d(i,{emoji:"â–¶ï¸",size:18}),e[24]||(e[24]=m(" ì¬ìƒí•˜ê¸° ",-1))])])]),l.showEmbedModal?(c(),p("div",{key:0,class:"modal-overlay",onClick:e[11]||(e[11]=(...C)=>a.closeEmbedModal&&a.closeEmbedModal(...C))},[s("div",{class:"modal-content embed-modal",onClick:e[10]||(e[10]=E(()=>{},["stop"]))},[s("div",Pi,[s("h3",null,[d(i,{emoji:"ğŸ”—",size:20}),e[25]||(e[25]=m(" ì„ë² ë“œ ì½”ë“œ ìƒì„± ",-1))]),s("button",{onClick:e[4]||(e[4]=(...C)=>a.closeEmbedModal&&a.closeEmbedModal(...C)),class:"close-button"},[d(i,{emoji:"âœ–ï¸",size:18})])]),s("div",Ei,[s("div",Ri,[e[33]||(e[33]=s("h4",null,"1ë‹¨ê³„: JSON íŒŒì¼ í˜¸ìŠ¤íŒ…",-1)),e[34]||(e[34]=s("p",{class:"help-text"}," ë¨¼ì € JSONì„ ë‚´ë³´ë‚´ê¸°í•˜ì—¬ ì›¹ì—ì„œ ì ‘ê·¼ ê°€ëŠ¥í•œ ê³³ì— ì—…ë¡œë“œí•˜ì„¸ìš”. ",-1)),s("div",Ni,[s("div",Oi,[d(i,{emoji:"âœ…",size:14}),e[26]||(e[26]=s("strong",null,"ì¶”ì²œ:",-1)),e[27]||(e[27]=m(" GitHub Gist, GitHub Pages, JSFiddle ",-1))]),s("div",Fi,[d(i,{emoji:"ğŸ’¡",size:14}),e[28]||(e[28]=s("strong",null,"íŒ:",-1)),e[29]||(e[29]=m(" DropboxëŠ” dl=0ì„ dl=1ë¡œ, ì¹´ì¹´ì˜¤ ë¸”ë¡œê·¸ëŠ” attach=1ì„ attach=0ìœ¼ë¡œ ë³€ê²½ (ìë™ ì²˜ë¦¬ë¨) ",-1))]),s("div",Ai,[d(i,{emoji:"âš ï¸",size:14}),e[30]||(e[30]=s("strong",null,"ì‘ë™ ì•ˆ í•¨:",-1)),e[31]||(e[31]=m(" Google Drive, OneDrive (CORS/Referer ì œí•œ) ",-1))])]),s("button",{onClick:e[5]||(e[5]=(...C)=>a.exportJSON&&a.exportJSON(...C)),class:"export-link-button"},[d(i,{emoji:"ğŸ“¤",size:16}),e[32]||(e[32]=m(" JSON ë‚´ë³´ë‚´ê¸° ",-1))])]),s("div",Li,[e[35]||(e[35]=s("h4",null,"2ë‹¨ê³„: JSON URL ì…ë ¥",-1)),f(s("input",{"onUpdate:modelValue":e[6]||(e[6]=C=>l.embedJsonUrl=C),type:"url",placeholder:"https://ohohod.github.io/embeded-test.json",class:"embed-url-input"},null,512),[[b,l.embedJsonUrl]])]),s("div",Mi,[e[37]||(e[37]=s("h4",null,"3ë‹¨ê³„: ì˜µì…˜ ì„¤ì •",-1)),s("div",Hi,[s("label",Ji,[f(s("input",{"onUpdate:modelValue":e[7]||(e[7]=C=>l.embedAutoplay=C),type:"checkbox"},null,512),[[P,l.embedAutoplay]]),e[36]||(e[36]=s("span",null,"ìë™ ì¬ìƒ",-1))])])]),s("div",Gi,[e[38]||(e[38]=s("h4",null,"4ë‹¨ê³„: ì„ë² ë“œ ì½”ë“œ ë³µì‚¬",-1)),s("div",Wi,[s("pre",null,[s("code",null,y(a.generatedEmbedCode),1)])]),s("button",{onClick:e[8]||(e[8]=(...C)=>a.copyEmbedCode&&a.copyEmbedCode(...C)),class:w(["copy-button",{copied:l.embedCopied}])},[d(i,{emoji:l.embedCopied?"âœ…":"ğŸ“‹",size:16},null,8,["emoji"]),m(" "+y(l.embedCopied?"ë³µì‚¬ ì™„ë£Œ!":"ì½”ë“œ ë³µì‚¬"),1)],2)]),l.embedJsonUrl?(c(),p("div",Xi,[s("h4",null,[d(i,{emoji:"ğŸ‘ï¸",size:18}),e[39]||(e[39]=m(" ë¯¸ë¦¬ë³´ê¸° ",-1))]),e[43]||(e[43]=s("p",{class:"help-text"},"ì‹¤ì œ ì„ë² ë“œ í”Œë ˆì´ì–´ê°€ ì´ë ‡ê²Œ í‘œì‹œë©ë‹ˆë‹¤:",-1)),s("div",qi,[l.embedPreviewLoaded?g("",!0):(c(),p("div",Ki,[...e[40]||(e[40]=[s("div",{class:"loading-spinner"},null,-1),s("span",null,"ë¡œë”© ì¤‘...",-1)])])),s("iframe",{src:a.embedPreviewUrl,width:"100%",height:"100%",frameborder:"0",allowfullscreen:"",sandbox:"allow-scripts allow-same-origin allow-popups allow-forms",class:"preview-iframe",onLoad:e[9]||(e[9]=C=>l.embedPreviewLoaded=!0)},null,40,Yi)]),s("p",Qi,[d(i,{emoji:"ğŸ’¡",size:14}),e[41]||(e[41]=m(" ë¯¸ë¦¬ë³´ê¸°ê°€ í‘œì‹œë˜ì§€ ì•Šìœ¼ë©´ JSON URLì´ CORSë¥¼ ì§€ì›í•˜ëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”. ",-1))]),l.embedPreviewLoaded?(c(),p("p",Zi,[d(i,{emoji:"âš ï¸",size:14}),e[42]||(e[42]=m(" ì„ë² ë“œ í”Œë ˆì´ì–´ëŠ” íƒ€ì‚¬ ì½˜í…ì¸ ë¥¼ í¬í•¨í•  ìˆ˜ ìˆìœ¼ë©°, í•´ë‹¹ ì½˜í…ì¸ ì˜ ë²•ì  ì±…ì„ì€ í•´ë‹¹ ì½˜í…ì¸  ì œê³µìì—ê²Œ ìˆìŠµë‹ˆë‹¤. ",-1))])):g("",!0)])):g("",!0)])])])):g("",!0),s("div",$i,[l.activeTab!=="css"?(c(),p("div",er,[s("div",tr,[s("h3",null,"ìŠ¤í… ëª©ë¡ ("+y(a.totalSteps)+"ê°œ)",1)]),s("div",sr,[(c(!0),p(k,null,U(a.allSteps,(C,j)=>(c(),p("div",{key:C.id,class:w(["step-item",{"has-effects":a.hasEffects(C),selected:l.selectedStepIndex===j}]),onClick:Vr=>a.selectStep(j)},[s("div",or,y(j+1),1),s("div",ar,[s("div",ir,y(C.character.name||"ì‹œìŠ¤í…œ"),1),s("div",rr,y(a.truncateText(C.text,50)),1),a.hasEffects(C)?(c(),p("div",nr,[C.effects.sfx?(c(),p("span",dr,[d(i,{emoji:"ğŸ”Š",size:12})])):g("",!0),C.effects.bgm?(c(),p("span",ur,[d(i,{emoji:"ğŸµ",size:12})])):g("",!0),C.effects.background?(c(),p("span",cr,[d(i,{emoji:"ğŸ–¼ï¸",size:12})])):g("",!0)])):g("",!0)])],10,lr))),128))])])):g("",!0),s("div",pr,[s("div",hr,[s("button",{class:w(["tab-button",{active:l.activeTab==="info"}]),onClick:e[12]||(e[12]=C=>l.activeTab="info")},[d(i,{emoji:"ğŸ“",size:16}),e[44]||(e[44]=m(" ì •ë³´ ìˆ˜ì • ",-1))],2),s("button",{class:w(["tab-button",{active:l.activeTab==="effects"}]),onClick:e[13]||(e[13]=C=>l.activeTab="effects")},[d(i,{emoji:"âœ¨",size:16}),e[45]||(e[45]=m(" íš¨ê³¼ í¸ì§‘ ",-1))],2),s("button",{class:w(["tab-button",{active:l.activeTab==="characters"}]),onClick:e[14]||(e[14]=C=>l.activeTab="characters")},[d(i,{emoji:"ğŸ‘¥",size:16}),e[46]||(e[46]=m(" ìºë¦­í„° ì¼ê´„í¸ì§‘ ",-1))],2),s("button",{class:w(["tab-button",{active:l.activeTab==="images"}]),onClick:e[15]||(e[15]=C=>l.activeTab="images")},[d(i,{emoji:"ğŸ–¼ï¸",size:16}),e[47]||(e[47]=m(" ì´ë¯¸ì§€ ì¼ê´„í¸ì§‘ ",-1))],2),s("button",{class:w(["tab-button",{active:l.activeTab==="css"}]),onClick:e[16]||(e[16]=C=>l.activeTab="css")},[d(i,{emoji:"ğŸ¨",size:16}),e[48]||(e[48]=m(" CSS ì»¤ìŠ¤í„°ë§ˆì´ì§• ",-1))],2)]),s("div",mr,[l.activeTab==="info"?(c(),p("div",fr,[d(o,{"step-data":a.selectedStep,onSave:a.handleSaveStepInfo,onDelete:a.handleDeleteStep,onDuplicate:a.handleDuplicateStep,onClose:e[17]||(e[17]=C=>l.activeTab="effects")},null,8,["step-data","onSave","onDelete","onDuplicate"])])):g("",!0),l.activeTab==="effects"?(c(),p("div",gr,[d(v,{"total-steps":a.totalSteps,"selected-step":l.selectedStepIndex!==null?l.selectedStepIndex+1:null,"current-effects":a.selectedStepEffects,"current-illustrations":((S=a.selectedStep)==null?void 0:S.illustrations)||[],onApply:a.handleApplyEffects,onRemove:a.handleRemoveEffects,onApplyIllustrationsRange:a.handleApplyIllustrationsRange,onClose:e[18]||(e[18]=C=>l.activeTab="info")},null,8,["total-steps","selected-step","current-effects","current-illustrations","onApply","onRemove","onApplyIllustrationsRange"])])):g("",!0),l.activeTab==="characters"?(c(),p("div",vr,[d(n,{"all-steps":a.allSteps,onBulkUpdate:a.handleBulkUpdateCharacter,onClose:e[19]||(e[19]=C=>l.activeTab="info")},null,8,["all-steps","onBulkUpdate"])])):g("",!0),l.activeTab==="images"?(c(),p("div",br,[d(u,{"vn-data":h.logStore.vnData,onBulkUpdate:a.handleBulkUpdateImage,onClose:e[20]||(e[20]=C=>l.activeTab="info")},null,8,["vn-data","onBulkUpdate"])])):g("",!0),l.activeTab==="css"?(c(),p("div",yr,[d(V,{"initial-c-s-s":((B=h.logStore.vnData)==null?void 0:B.customCSS)||{},onSave:a.handleSaveCustomCSS},null,8,["initial-c-s-s","onSave"])])):g("",!0)])])])])])}const Ur=D(Ii,[["render",Cr],["__scopeId","data-v-9011a658"]]);export{Ur as default};
